ggbackground(gg = gf, background = megan)
meganURL = "https://heavyeditorial.files.wordpress.com/2019/06/gettyimages-1158881418-e1562092629846.jpg?quality=65&strip=all&w=780"
ggbackground(gg = gf, background = meganURL)
gf
img = load.image("C:/Users/coleb/Documents/GitHub/Tidy-Tuesday-/trophy.png")
img = rasterGrob(img, interpolate = FALSE)
gf = gf + geom_blank(data = all_gf_w, aes(year, gf)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.8, xmax=xx+0.8, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = 'Goals For Per Game', title = 'Most Goals For Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
#initial plot
gf = ggplot() +
geom_point(data = all_gf, aes(x = year, y = gf, colour = 'red'), size = 4)
gf = gf + geom_blank(data = all_gf_w, aes(year, gf)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.8, xmax=xx+0.8, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = 'Goals For Per Game', title = 'Most Goals For Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
gf
img = load.image("C:/Users/coleb/Documents/GitHub/Tidy-Tuesday-/trophy.png")
img = rasterGrob(img, interpolate = FALSE)
#initial plot
gf = ggplot() +
geom_point(data = all_gf, aes(x = year, y = gf, colour = 'red'), size = 4)
gf = gf + geom_blank(data = all_gf_w, aes(year, gf)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.8, xmax=xx+0.8, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = 'Goals For Per Game', title = 'Most Goals For Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
gf
img = load.image("C:/Users/coleb/Documents/GitHub/Tidy-Tuesday-/trophy.png")
img = rasterGrob(img, interpolate = FALSE)
#initial plot
gf = ggplot() +
geom_point(data = all_gf, aes(x = year, y = gf, colour = 'red'), size = 4)
gf = gf + geom_blank(data = all_gf_w, aes(year, gf)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.8, xmax=xx+0.8, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = 'Goals For Per Game', title = 'Most Goals For Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
gf
#initial plot
gf = ggplot() +
geom_point(data = all_gf, aes(x = year, y = gf, colour = 'red'), size = 4)
gf = gf + geom_blank(data = all_gf_w, aes(year, gf)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = 'Goals For Per Game', title = 'Most Goals For Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
gf
#initial plot
ga = ggplot() +
geom_point(data = all_ga, aes(x = year, y = ga, colour = 'red'), size = 4)
#add trophies
ga = ga + geom_blank(data = all_ga_w, aes(year, ga)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.8, xmax=xx+0.8, ymin=yy-0.15, ymax=yy+0.15)},
all_ga_w$year, all_ga_w$ga, seq_len(nrow(all_ga_w))) +
labs(x = 'Year', y = 'Goals Against Per Game', title = 'Fewest Goals Against Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
ga
#initial plot
ga = ggplot() +
geom_point(data = all_ga, aes(x = year, y = ga, colour = 'red'), size = 4)
#add trophies
ga = ga + geom_blank(data = all_ga_w, aes(year, ga)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_ga_w$year, all_ga_w$ga, seq_len(nrow(all_ga_w))) +
labs(x = 'Year', y = 'Goals Against Per Game', title = 'Fewest Goals Against Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
ga
#initial plot
ga = ggplot() +
geom_point(data = all_ga, aes(x = year, y = ga, colour = 'red4'), size = 4)
#add trophies
ga = ga + geom_blank(data = all_ga_w, aes(year, ga)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_ga_w$year, all_ga_w$ga, seq_len(nrow(all_ga_w))) +
labs(x = 'Year', y = 'Goals Against Per Game', title = 'Fewest Goals Against Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
ga
#initial plot
ga = ggplot() +
geom_point(data = all_ga, aes(x = year, y = ga, colour = 'red1'), size = 4)
#add trophies
ga = ga + geom_blank(data = all_ga_w, aes(year, ga)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_ga_w$year, all_ga_w$ga, seq_len(nrow(all_ga_w))) +
labs(x = 'Year', y = 'Goals Against Per Game', title = 'Fewest Goals Against Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
ga
library(RColorBrewer)
#initial plot
ga = ggplot() +
geom_point(data = all_ga, aes(x = year, y = ga, colour = 'red4'), size = 4)
#add trophies
ga = ga + geom_blank(data = all_ga_w, aes(year, ga)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_ga_w$year, all_ga_w$ga, seq_len(nrow(all_ga_w))) +
labs(x = 'Year', y = 'Goals Against Per Game', title = 'Fewest Goals Against Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
ga
#initial plot
ga = ggplot() +
geom_point(data = all_ga, aes(x = year, y = ga, fill = 'red4'), size = 4)
#add trophies
ga = ga + geom_blank(data = all_ga_w, aes(year, ga)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_ga_w$year, all_ga_w$ga, seq_len(nrow(all_ga_w))) +
labs(x = 'Year', y = 'Goals Against Per Game', title = 'Fewest Goals Against Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
ga
#initial plot
ga = ggplot() +
geom_point(data = all_ga, aes(x = year, y = ga, col = 'red4'), size = 4)
#add trophies
ga = ga + geom_blank(data = all_ga_w, aes(year, ga)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_ga_w$year, all_ga_w$ga, seq_len(nrow(all_ga_w))) +
labs(x = 'Year', y = 'Goals Against Per Game', title = 'Fewest Goals Against Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
ga
#initial plot
ga = ggplot() +
geom_point(data = all_ga, aes(x = year, y = ga, col = 'midnightblue'), size = 4)
#add trophies
ga = ga + geom_blank(data = all_ga_w, aes(year, ga)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_ga_w$year, all_ga_w$ga, seq_len(nrow(all_ga_w))) +
labs(x = 'Year', y = 'Goals Against Per Game', title = 'Fewest Goals Against Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
ga
#initial plot
ga = ggplot() +
geom_point(data = all_ga, aes(x = year, y = ga, colour = 'midnightblue'), size = 4)
#add trophies
ga = ga + geom_blank(data = all_ga_w, aes(year, ga)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_ga_w$year, all_ga_w$ga, seq_len(nrow(all_ga_w))) +
labs(x = 'Year', y = 'Goals Against Per Game', title = 'Fewest Goals Against Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
ga
#initial plot
ga = ggplot() +
geom_point(data = all_ga, aes(x = year, y = ga), colour = 'midnightblue', size = 4)
#add trophies
ga = ga + geom_blank(data = all_ga_w, aes(year, ga)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_ga_w$year, all_ga_w$ga, seq_len(nrow(all_ga_w))) +
labs(x = 'Year', y = 'Goals Against Per Game', title = 'Fewest Goals Against Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
ga
#initial plot
ga = ggplot() +
geom_point(data = all_ga, aes(x = year, y = ga), colour = 'red4', size = 4)
#add trophies
ga = ga + geom_blank(data = all_ga_w, aes(year, ga)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_ga_w$year, all_ga_w$ga, seq_len(nrow(all_ga_w))) +
labs(x = 'Year', y = 'Goals Against Per Game', title = 'Fewest Goals Against Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
ga
#initial plot
ga = ggplot() +
geom_point(data = all_ga, aes(x = year, y = ga), colour = 'red3', size = 4)
#add trophies
ga = ga + geom_blank(data = all_ga_w, aes(year, ga)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_ga_w$year, all_ga_w$ga, seq_len(nrow(all_ga_w))) +
labs(x = 'Year', y = 'Goals Against Per Game', title = 'Fewest Goals Against Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
ga
#initial plot
gf = ggplot() +
geom_point(data = all_gf, aes(x = year, y = gf), colour = 'red3', size = 4)
gf = gf + geom_blank(data = all_gf_w, aes(year, gf)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = 'Goals For Per Game', title = 'Most Goals For Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
ga = ggplot() +
geom_point(data = all_ga, aes(x = year, y = ga), colour = 'red3', size = 4)
#add trophies
ga = ga + geom_blank(data = all_ga_w, aes(year, ga)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_ga_w$year, all_ga_w$ga, seq_len(nrow(all_ga_w))) +
labs(x = 'Year', y = "Lowest 'Goals Against' Per Game", title = 'Fewest Goals Against Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
#initial plot
gf = ggplot() +
geom_point(data = all_gf, aes(x = year, y = gf), colour = 'red3', size = 4)
gf = gf + geom_blank(data = all_gf_w, aes(year, gf)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = "Highest 'Goals For' Per Game", title = 'Most Goals For Per Game in WWC History') +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
library(cowplot)
gf_ga = plot_grid(gf, ga)
gf_ga
ga = ggplot() +
geom_point(data = all_ga, aes(x = year, y = ga), colour = 'red3', size = 4)
#add trophies
ga = ga + geom_blank(data = all_ga_w, aes(year, ga)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_ga_w$year, all_ga_w$ga, seq_len(nrow(all_ga_w))) +
labs(x = 'Year', y = "Lowest 'Goals Against' Per Game", title = "Fewest 'Goals Against' Per Game Each Year in WWC History") +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
#initial plot
gf = ggplot() +
geom_point(data = all_gf, aes(x = year, y = gf), colour = 'red3', size = 4)
gf = gf + geom_blank(data = all_gf_w, aes(year, gf)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = "Highest 'Goals For' Per Game", title = "Most 'Goals For' Per Game Each Year in WWC History") +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
gf_ga = plot_grid(gf, ga)
gf_ga
gf_ga = plot_grid(gf, ga, rel_widths = c(1.1, 1.1))
gf_ga
gf_ga = plot_grid(gf, ga, rel_widths = c(0.9, 1))
gf_ga
gf_ga = plot_grid(gf, ga, rel_widths = c(0.95, 1))
gf_ga
#get megan rapinoe because why not
megan = load.image("C:/Users/coleb/Documents/GitHub/Tidy-Tuesday-/mrapinoe1.png")
megan = rasterGrob(megan, interpolate = FALSE)
ggbackground(gg = gf_ga, background = megan)
str(gf_ga)
gf_ga = gf_ga +
annotate_custom(megan, xmin = Inf, xmax = Inf, ymax = Inf, ymin = Inf)
gf_ga = gf_ga +
annotation_custom(megan, xmin = Inf, xmax = Inf, ymax = Inf, ymin = Inf)
gf_ga
gf = ggplot() +
geom_point(data = all_gf, aes(x = year, y = gf), colour = 'red3', size = 4)
#add trophies
gf = gf + geom_blank(data = all_gf_w, aes(year, gf)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = "Highest 'Goals For' Per Game", title = "Most 'Goals For' Per Game Each Year in WWC History") +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))+
annotation_custom(megan, xmin = Inf, xmax = Inf, ymax = Inf, ymin = Inf)
gf
install.packages('grid')
library(grid)
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = "Highest 'Goals For' Per Game", title = "Most 'Goals For' Per Game Each Year in WWC History") +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))+
annotation_custom(megan, xmin = Inf, xmax = Inf, ymax = Inf, ymin = Inf)
gf = ggplot() +
geom_point(data = all_gf, aes(x = year, y = gf), colour = 'red3', size = 4)
#add trophies
gf = gf + geom_blank(data = all_gf_w, aes(year, gf)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = "Highest 'Goals For' Per Game", title = "Most 'Goals For' Per Game Each Year in WWC History") +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))+
annotation_custom(megan, xmin = Inf, xmax = Inf, ymax = Inf, ymin = Inf)
gf
megan = rasterGrob(megan, interpolate = TRUE)
#get megan rapinoe because why not
megan = load.image("C:/Users/coleb/Documents/GitHub/Tidy-Tuesday-/mrapinoe1.png")
megan = rasterGrob(megan, interpolate = TRUE)
#initial plot
gf = ggplot() +
geom_point(data = all_gf, aes(x = year, y = gf), colour = 'red3', size = 4)
#add trophies
gf = gf + geom_blank(data = all_gf_w, aes(year, gf)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = "Highest 'Goals For' Per Game", title = "Most 'Goals For' Per Game Each Year in WWC History") +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))+
annotation_custom(megan, xmin = Inf, xmax = Inf, ymax = Inf, ymin = Inf)
gf
#get megan rapinoe because why not
megan = load.image("C:/Users/coleb/Documents/GitHub/Tidy-Tuesday-/mrapinoe.png")
megan = rasterGrob(megan, interpolate = TRUE)
#initial plot
gf = ggplot() +
geom_point(data = all_gf, aes(x = year, y = gf), colour = 'red3', size = 4)
#add trophies
gf = gf + geom_blank(data = all_gf_w, aes(year, gf)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = "Highest 'Goals For' Per Game", title = "Most 'Goals For' Per Game Each Year in WWC History") +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))+
annotation_custom(megan, xmin = Inf, xmax = Inf, ymax = Inf, ymin = Inf)
gf
#initial plot
gf = ggplot() +
geom_point(data = all_gf, aes(x = year, y = gf), colour = 'red3', size = 4)
gf + geom_blank(data = all_gf_w, aes(year, gf)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = "Highest 'Goals For' Per Game", title = "Most 'Goals For' Per Game Each Year in WWC History") +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))+
annotation_custom(megan, xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf)
#get megan rapinoe because why not
megan = load.image("C:/Users/coleb/Documents/GitHub/Tidy-Tuesday-/mrapinoe.png")
megan = rasterGrob(megan, interpolate = TRUE)
megan = rasterGrob(megan, interpolate = FALSE)
#get megan rapinoe because why not
megan = load.image("C:/Users/coleb/Documents/GitHub/Tidy-Tuesday-/mrapinoe.png")
megan = rasterGrob(megan, interpolate = FALSE)
#initial plot
gf = ggplot() +
geom_point(data = all_gf, aes(x = year, y = gf), colour = 'red3', size = 4)
#add trophies
gf = gf + geom_blank(data = all_gf_w, aes(year, gf)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = "Highest 'Goals For' Per Game", title = "Most 'Goals For' Per Game Each Year in WWC History") +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))+
annotation_custom(megan, xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf)
gf
#get megan rapinoe because why not
megan = load.image("C:/Users/coleb/Documents/GitHub/Tidy-Tuesday-/megan1.png")
megan = rasterGrob(megan, interpolate = FALSE)
print(megan)
plot(megan)
#initial plot
gf = ggplot() +
geom_point(data = all_gf, aes(x = year, y = gf), colour = 'red3', size = 4)
#add trophies
gf = gf + geom_blank(data = all_gf_w, aes(year, gf)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = "Highest 'Goals For' Per Game", title = "Most 'Goals For' Per Game Each Year in WWC History") +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))+
annotation_custom(megan, xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf)
gf
gf = ggplot() +
geom_point(data = all_gf, aes(x = year, y = gf), colour = 'red3', size = 4)
#add trophies
gf = gf + geom_blank(data = all_gf_w, aes(year, gf)) +
mapply(function(xx, yy, ii) {
img$name <- ii
annotation_custom(img, xmin=xx-0.6, xmax=xx+0.6, ymin=yy-0.15, ymax=yy+0.15)},
all_gf_w$year, all_gf_w$gf, seq_len(nrow(all_gf_w))) +
labs(x = 'Year', y = "Highest 'Goals For' Per Game", title = "Most 'Goals For' Per Game Each Year in WWC History") +
theme1() +
scale_x_continuous(breaks = c(1991, 1995, 1999, 2003, 2007, 2011, 2015, 2019))
gf_ga = plot_grid(gf, ga, rel_widths = c(0.95, 1))
gf_ga
ramen_ratings <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-06-04/ramen_ratings.csv")
library(tidyverse)
library(scales)
library(viridis)
library(maps)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)
library(data.table)
#quick peek at the data
summary(ramen_ratings)
n_distinct(ramen_ratings$brand); n_distinct(ramen_ratings$variety); n_distinct(ramen_ratings$style)
ramen_ratings = ramen_ratings %>%
filter(stars != "NA")
unique(ramen_ratings$country) #so we can see there are some countries here that a) have typos and b) aren't the proper names
## let's make the map to see what it looks like then join some data to it to make our chloropleth
world = ne_countries(scale = 'medium', returnclass = 'sf')
#let's check that my countries are in the world countries
my_countries = unique(ramen_ratings$country) %in% world$sovereignt
#some of my countries aren't names properly, so let's fix that - there are misspellings, duplicates and false names
ramen_ratings = ramen_ratings %>%
mutate(country = replace(country, country == 'Dubai', 'United Arab Emirates')) %>%
mutate(country = replace(country, country == 'Holland', 'Netherlands')) %>%
mutate(country = replace(country, country == 'Hong Kong', 'China')) %>%
mutate(country = replace(country, country == 'Phlippines', 'Philippines')) %>%
mutate(country = replace(country, country == 'United States', 'United States of America')) %>%
mutate(country = replace(country, country == 'Sarawak', 'Malaysia')) %>%
mutate(country = replace(country, country == 'USA', 'United States of America')) %>%
mutate(country = replace(country, country == 'UK', 'United Kingdom'))
#now that thats done, lets see what this world map looks like
map = ggplot(data = world) +
geom_sf()
#now, let's join our ratings data to the world data so we can colour by that data
ratings_by_c = ramen_ratings %>%
group_by(country) %>%
dplyr::summarise(Prop_Stars = mean(stars)) %>%
rename(sovereignt = country)
#use data.table to set keys so we can left-join
setDT(world); setkey(world, sovereignt)
setDT(ratings_by_c); setkey(ratings_by_c, sovereignt)
#perform merge
world = merge(world, ratings_by_c, all = TRUE)
#now let's plot our map again but let's make it coloured by our mean stars category
map = ggplot(data = world) +
geom_sf(colour = 'grey20', aes(fill = Prop_Stars)) +
scale_fill_viridis_c(option = 'plasma', na.value = 'grey80', name = 'Mean Star Rating \nOut of Five') +
coord_sf(ylim = c(-55,80), xlim = c(-170, 170)) +
theme_bw() +
labs(title = 'Average Ramen Rating by Country', x = 'Latitude', y = 'Longitude') +
ggplot2::theme(legend.position = c(0.071,0.267),
legend.background = element_rect(colour = 'black'),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6.5))
map
#now let's plot our map again but let's make it coloured by our mean stars category
map = ggplot(data = world) +
geom_sf(colour = 'grey20', aes(fill = Prop_Stars)) +
scale_fill_viridis_c(option = 'plasma', na.value = 'grey80', name = 'Mean Star Rating \nOut of Five') +
coord_sf(ylim = c(-55,80), xlim = c(0, -180)) +
theme_bw() +
labs(title = 'Average Ramen Rating by Country', x = 'Latitude', y = 'Longitude') +
ggplot2::theme(legend.position = c(0.071,0.267),
legend.background = element_rect(colour = 'black'),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6.5))
map
?geom_sf
#now let's plot our map again but let's make it coloured by our mean stars category
map = ggplot(data = world) +
geom_sf(colour = 'grey20', aes(fill = Prop_Stars)) +
scale_fill_viridis_c(option = 'plasma', na.value = 'grey80', name = 'Mean Star Rating \nOut of Five') +
coord_sf(ylim = c(-55,80), xlim = c(-170, 170)) +
theme_bw() +
labs(title = 'Average Ramen Rating by Country', x = 'Latitude', y = 'Longitude') +
ggplot2::theme(legend.position = c(0.071,0.267),
legend.background = element_rect(colour = 'black'),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6.5))
map
