setwd("C:/Users/coleb/Dropbox/SalmonWork")
mainlice <- read.csv("Hakai_lice_data_CB_edits.csv")
licebysite <- read.csv("Hakai_lice_by_site.csv")

#Load some relevant packages

library(tidyverse)
library(cowplot)
library(bbmle)
library(lubridate)
library(rsample)
library(tibble)
library(glmmTMB)
library(ggeffects)

# First lets take a look at some of the summary statistics with the data and get a handle on it. 
# we'll look at the structure of the dataframe, and we'll also spend some time subsetting it into 'workable intervals'

# View(mainlice)
# head(mainlice)
# summary(mainlice)
# names(mainlice)
# str(mainlice)
# 
# 
# 
# fishpersite <- mainlice %>% 
#   group_by(., site.id) %>% 
#   tally()
# fishpersite
# 
# licepersite <- mainlice %>% 
#   group_by(., site.id) %>% 
#   count(., all.lice)
# licepersite
# #Lets try plotting lice per fish by adding all the items into a new variable and plotting that vs fish 
# names(mainlice)
# 
# # #add all lice column
# mainlice <- mainlice %>%
#   rowwise() %>%
#   mutate(all.lice = sum(c(cal.mot.notgf,cal.gf,lep.pam,lep.paf,lep.am,lep.af,lep.gf,lep.mot.unid.notgf), na.rm = TRUE))
# 
# #split lice into all lice per species of lice
# mainlice <- mainlice %>%
#   rowwise() %>%
#   mutate(all.cal = sum(c(cal.mot.notgf,cal.gf), na.rm = TRUE))
# mainlice <- mainlice %>%
#   rowwise() %>%
#   mutate(all.leps = sum(c(lep.pam,lep.paf,lep.am,lep.af,lep.gf,lep.mot.unid.notgf), na.rm = TRUE))
# 
# #add site code (Johnstone Strait vs. Discovery Islands)
# mainlice <- mainlice %>% 
#   mutate(site.region = site.id)
# mainlice$site.region<- substr(mainlice$site.region, 0, 1)
# 
# 
# # Add in year and julian day columns
# 
# 
# mainlice <- mainlice %>% 
#   mutate(year = format(as.Date(mainlice$date, format="%m/%d/%Y"),"%Y"))
# mainlice$year <- as.factor(mainlice$year)
# 
# write.csv(mainlice, file = "Hakai_lice_data_CB_edits.csv")

# pliceperfish <- ggplot(data = mainlice, aes(x = all.lice)) + 
#   geom_histogram(binwidth = 1) + theme_classic() #+ 
#   #coord_cartesian(xlim = c(1,40))
# #note, there are almost 1000 observations where all.lice = 0
# pliceperfish
# 
# 
# plicepersite <- ggplot(data = mainlice, aes(x = site.id, y = all.lice)) +
#   geom_col() + theme_classic()
# plicepersite
# 
# 
# pfishpersite <- mainlice %>% 
#   ggplot(., aes(x = site.id)) + geom_histogram(stat = 'count') +
#   theme_classic()
# pfishpersite
# 
# pliceperfishpersite <- licebysite %>% 
#   ggplot(., aes(x = ?..site.id, y = lice.per.fish)) + 
#   geom_col() +
#   theme_classic()
# pliceperfishpersite

################################################# 10/10/18 ################################################

#########Sort the data into 'collections', aka, groupings of unique date/location combinations 
#########This will allow us to look at the data across these collections and make predictions/observations


# ended up just adding a new column in excel 


# average number of parasites per fish per species is important, 
# then also calculate the total number of parasites in the collection and 
# then calculate the proportion of parasites on each of the species 
# (that'll be six quantities per collection to calculate) - therefore that'll 
# put the stats on the same scale for each collection - for the proportion quantities 
# calculate a mean and a variance for that and see where we're at from there 


#calculate proportion of parasites per species


 meanliceperfishpersp <- mainlice %>% 
   group_by(., collection, spp) %>% 
   summarize(., mean(all.lice))
 meanliceperfishpersp <- rename(meanliceperfishpersp, av.lice = `mean(all.lice)`)
 meanliceperfishpersp

# licepercollection <- data.frame(mainlice %>% 
#                                   group_by(., collection) %>% 
#                                   summarize(., sum(all.lice)))
# licepercollection
# 
# liceperspppercollection <- data.frame(mainlice %>% 
#                                         group_by(., collection, spp) %>% 
#                                         summarize(., num.lice = sum(all.lice)))
# liceperspppercollection
# 
# library(plyr)
# 
# propliceperfishsp<-as.vector(ddply(liceperspppercollection,.(collection),transform,prop=num.lice/sum(num.lice)))
# 
# 
# library(tidyverse)
# 
# 
# s.statspcpsp <- meanliceperfishpersp %>% 
#   mutate(proportion = propliceperfishsp$prop, 
#          num.lice = propliceperfishsp$num.lice) 
# s.statspcpsp
# s.statspcpsp <- dplyr::rename(s.statspcpsp, av.lice = `mean(all.lice)`)

# calculate the mean and variance for the proportion 


# meanprop <- s.statspcpsp %>% 
#   group_by(., spp) %>% 
#   summarize(mean.prop = mean(proportion))
# meanprop
# 
# varprop <- s.statspcpsp %>% 
#   group_by(., spp) %>% 
#   summarize(var.pop = var(proportion))
# varprop

# #plot the mean and prop of the different species across the collections 
# 
# s.statpropplot <- s.statspcpsp %>% 
#   group_by(., spp) %>% 
#   ggplot(., aes(x = collection, y = proportion, fill = spp)) + 
#   geom_histogram(stat = "identity")
# s.statpropplot

s.statmeanplot <- meanliceperfishpersp %>% 
  group_by(., spp) %>% 
  ggplot(., aes(x = collection, y = av.lice, fill = spp)) + 
  geom_histogram(stat = "identity") +
  theme_classic()+ 
  scale_color_manual(values=c('seagreen2', 'hotpink3', 'steelblue2')) +
  scale_fill_manual(values=c('seagreen2', 'hotpink1', 'steelblue3'), 
                    name = 'Salmon Species', labels = c('Chum', 'Pink', 'Sockeye')) + 
  labs(x = 'Collection', y = 'Average Number of Motile Lice per Fish')+  
  theme(legend.position = c(0.85,0.7))+ 
  scale_y_continuous(limits=c(0,5))+
  annotate('text', x = 25, y = 5, label= 'C. clemensi & L. salmonis', fontface = 3, size = 5)


s.statmeanplot
ggsave(s.statmeanplot, file = 'numberofliceperfishperspplot.png')

############################################### 10/15/18 ############################################

##### making the s.statmeanplot again but divide into caligus and leps lice separately (also change pink 
##### salmon to be pink colour)



## For Caligus 

#calculate mean Caligus per fish per species

meanCALperfishpersp <- mainlice %>% 
  group_by(., collection, spp) %>% 
  summarize(., mean(all.cal))
meanCALperfishpersp <- rename(meanCALperfishpersp, av.cal = `mean(all.cal)`)
meanCALperfishpersp

#calculate proportion of parasites per species

# prop1CAL <- mainlice %>% 
#   group_by(., collection) %>% 
#   summarize(., sum(all.cal))
# CALpercollection <- as.data.frame(prop1CAL)
# prop2CAL <- mainlice %>% 
#   group_by(., collection, spp) %>% 
#   summarize(., num.cal = sum(all.cal))
# prop2dfCAL <- as.data.frame(prop2CAL)
# prop2dfCAL


# library(plyr)
# 
# prop2attempt1CAL<-ddply(prop2dfCAL,.(collection),transform,prop=num.cal/sum(num.cal))
# 
# prop2df1CAL <- as.vector(prop2attempt1CAL)
# propCALperfishsp <- prop2df1CAL
# propCALperfishsp
# 
# library(tidyverse)

# 
# CALs.statspcpsp <- meanCALperfishpersp %>% 
#   mutate(proportion = propCALperfishsp$prop, 
#          num.cal = propCALperfishsp$num.cal) 
# 
# CALs.statspcpsp
# CALs.statspcpsp <- dplyr::rename(CALs.statspcpsp, av.cal = `mean(all.cal)`)

# calculate the mean and variance for the proportion 


# CALmeanprop <- CALs.statspcpsp %>% 
#   group_by(., spp) %>% 
#   summarize(mean.prop = mean(proportion))
# CALmeanprop
# 
# CALvarprop <- CALs.statspcpsp %>% 
#   group_by(., spp) %>% 
#   summarize(var.pop = var(proportion))
# CALvarprop

#plot the mean and prop of the different species across the collections 

# CALs.statpropplot <- meanCALperfishpersp %>% 
#   group_by(., spp) %>% 
#   ggplot(., aes(x = collection, y = proportion, fill = spp)) + 
#   geom_histogram(stat = "identity")
# CALs.statpropplot

CALs.statmeanplot <- meanCALperfishpersp %>% 
  group_by(., spp) %>% 
  ggplot(., aes(x = collection, y = av.cal, fill = spp)) + 
  geom_histogram(stat = "identity") +
  scale_y_continuous(limits = c(0,3))+
  theme_classic() +
  scale_color_manual(values=c('seagreen2', 'hotpink3', 'steelblue2')) +
  scale_fill_manual(values=c('seagreen2', 'hotpink1', 'steelblue3'),
                    name = 'Salmon Species', labels = c('Chum', 'Pink', 'Sockeye')) +
  labs(x = 'Collection', y = 'Average Number of Motile Lice per Fish')+
  theme(legend.position = 'None')+ 
  annotate('text', x = 25, y = 2.8, label= 'C. clemensi', fontface = 3, size = 5)
CALs.statmeanplot 

ggsave(CALs.statmeanplot, file = 'numberofcaligusperfishperspplot.png')


##For Leps
# library(tidyverse)
meanLEPperfishpersp <- mainlice %>% 
  group_by(., collection, spp) %>% 
  summarize(., mean(all.leps))
meanLEPperfishpersp <- rename(meanLEPperfishpersp, av.leps = `mean(all.leps)`)
meanLEPperfishpersp

#calculate proportion of parasites per species

# prop1LEP <- mainlice %>% 
#   group_by(., collection) %>% 
#   summarize(., sum(all.leps))
# LEPpercollection <- as.data.frame(prop1LEP)
# prop2LEP <- mainlice %>% 
#   group_by(., collection, spp) %>% 
#   summarize(., num.leps = sum(all.leps))
# prop2dfLEP <- as.data.frame(prop2LEP)
# prop2dfLEP


# library(plyr)
# 
# prop2attempt1LEP<-ddply(prop2dfLEP,.(collection),transform,prop=num.leps/sum(num.leps))
# 
# prop2df1LEP <- as.vector(prop2attempt1LEP)
# propLEPperfishsp <- prop2df1LEP
# propLEPperfishsp[is.na(propLEPperfishsp)] <- 0
# 
# library(tidyverse)
# 
# 
# LEPs.statspcpsp <- meanLEPperfishpersp %>% 
#   mutate(proportion = propLEPperfishsp$prop, 
#          num.leps = propLEPperfishsp$num.leps) 
# 
# LEPs.statspcpsp
# LEPs.statspcpsp <- dplyr::rename(LEPs.statspcpsp, av.leps = `mean(all.leps)`)
# 
# # calculate the mean and variance for the proportion 
# 
# 
# LEPmeanprop <- LEPs.statspcpsp %>% 
#   group_by(., spp) %>% 
#   summarize(mean.prop = mean(proportion))
# LEPmeanprop
# 
# LEPvarprop <- LEPs.statspcpsp %>% 
#   group_by(., spp) %>% 
#   summarize(var.pop = var(proportion))
# LPvarprop

#plot the mean and prop of the different species across the collections 

# LEPs.statpropplot <- LEPs.statspcpsp %>% 
#   group_by(., spp) %>% 
#   ggplot(., aes(x = collection, y = proportion, fill = spp)) + 
#   geom_histogram(stat = "identity")
# LEPs.statpropplot

LEPs.statmeanplot <- meanLEPperfishpersp %>% 
  group_by(., spp) %>% 
  ggplot(., aes(x = collection, y = av.leps, fill = spp)) + 
  geom_histogram(stat = "identity") +
  scale_y_continuous(limits = c(0,3))+
  theme_classic()+
  scale_color_manual(values=c('seagreen2', 'hotpink3', 'steelblue2')) +
  scale_fill_manual(values=c('seagreen2', 'hotpink1', 'steelblue3'),
                    name = 'Salmon Species', labels = c('Chum', 'Pink', 'Sockeye')) + 
  labs(x = 'Collection', y = 'Average Number of Motile Lice per Fish')+
  theme(legend.position = c(0.85,0.6))+ 
  annotate('text', x = 25, y = 2.8, label= 'L. salmonis', fontface = 3, size = 5)
LEPs.statmeanplot
ggsave(LEPs.statmeanplot, file = 'numlepsliceperfishperspplot.png')


CalvLep <- plot_grid(CALs.statmeanplot, LEPs.statmeanplot)
CalvLep 

### Map of Study Area
library(mapdata)
library(maps)
library(maptools)
library(ggmap)
library(ggrepel)
library(raster)
library(ggthemes)
library(ggsn)
salmonsites <- read.csv('Hakai_sampling_site_coordinates.csv')
names(salmonsites)
coords <- data.frame(cbind(salmonsites$Xlatitude,salmonsites$Ylongitutde))
colnames(coords) <- c('lat', 'long')

sort(unique(ggplot2::map_data("world")$region))
westcoast <- map_data('canada')

## make two themes, one for the inset, one for the big map
fte_theme <- function(){
  color.background = 'white'
  color.grid.major = 'black'
  color.axis.text = 'black'
  color.axis.title = 'black'
  color.title = 'black'
  theme_bw(base_size = 9) + 
    theme(panel.background = element_rect(fill=color.background,color = color.background)) +
    theme(plot.background = element_rect(fill = color.background, color = color.background)) +
    theme(panel.border = element_rect(colour = 'black')) +
    theme(panel.grid.major = element_blank()) + 
    theme(panel.grid.minor = element_blank()) + 
    theme(axis.ticks = element_blank()) +
    theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
    theme(axis.text.x = element_text(size = 8, color = color.axis.text, angle = 90)) + 
    theme(axis.text.y = element_text(size = 10, color = color.axis.text)) + 
    theme(axis.title.x = element_text(size = 12, color = color.axis.title, vjust = 0)) +
    theme(axis.title.y = element_text(size = 12, color = color.axis.title, vjust = 1.25)) +
    theme(plot.title = element_text(hjust = 0.5)) +
    theme(axis.line.x = element_line(color="black", size = 0.15),
          axis.line.y = element_line(color="black", size = 0.15)) 
}
fte_theme1 <- function(){
  color.background = 'white'
  color.grid.major = 'black'
  color.axis.text = 'black'
  color.axis.title = 'black'
  color.title = 'black'
  theme_bw(base_size = 9) + 
    theme(panel.background = element_rect(fill=color.background,color = color.background)) +
    theme(plot.background = element_rect(fill = color.background, color = color.background)) +
    theme(panel.border = element_rect(colour = 'black')) +
    theme(panel.grid.major = element_blank()) + 
    theme(panel.grid.minor = element_blank()) + 
    theme(axis.ticks = element_blank()) +
    theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
    theme(axis.text.x = element_blank()) + 
    theme(axis.text.y = element_blank()) + 
    theme(axis.title.x = element_blank()) +
    theme(axis.title.y = element_blank()) +
    theme(plot.title = element_blank()) +
    theme(axis.line.x = element_line(color="black", size = 0.15),
          axis.line.y = element_line(color="black", size = 0.15)) 
}
## create the two maps
states    <- c('Washington')
provinces <- c("British Columbia")

us <- getData("GADM",country="USA",level=1)
canada <- getData("GADM",country="CAN",level=1)

us.states <- us[us$NAME_1 %in% states,]
ca.provinces <- canada[canada$NAME_1 %in% provinces,]
biggermap <- 
  ggplot(data = us.states,aes(x=long,y=lat,group=group), colour = 'black')+
  geom_path()+
  geom_path(data=ca.provinces, colour = 'black')+
  ylim(c(48.1,52.5))+
  xlim(c(-130.5,-119.5))+
  coord_map()+
  fte_theme1()+
  annotate("rect", xmin = -127.3, xmax = -125, ymin = 49.8, ymax = 50.9, alpha = .4)+
  annotate('text', x = -121, y = 51.7, label = 'British Columbia', size = 3.5)+
  annotate('text', x = -127, y = 48.5, label = 'Vancouver Island', size = 3)+
  annotate('segment',x=-127, y=48.6, xend=-125.5, yend=49.5, arrow=arrow(length = unit(0.04, "npc")), 
           alpha = 0.8, size=1.1, color="black")
biggermap

smallermap <- ggplot()+
  geom_path(data=ca.provinces,aes(x=long,y=lat,group=group))+
  ylim(c(49.8,50.9))+
  xlim(c(-127.3,-125))+
  geom_point(data = coords, aes(long,lat), color = 'black', size = 4, shape = 21, fill = 'red3')+
  coord_map() +
  fte_theme()+
  labs(x = 'Longitude', y = 'Latitude', title = 'Sampling Sites')+
  annotate("rect", xmin = -125.51, xmax = -125.05, ymin = 50.1, ymax = 50.5, alpha = .4)+
  annotate("rect", xmin = -126.9, xmax = -126.55, ymin = 50.45, ymax = 50.7, alpha = .4)+
  annotate('text', x= -125.9, y = 50.03, label = 'Discovery Islands Region', size = 3)+
  annotate('text', x = -126.35, y = 50.25, label = 'Johnstone Strait Region', size = 3)+
  annotate('segment',x=-125.9, y=50.05, xend=-125.58, yend=50.31, arrow=arrow(length = unit(0.04, "npc")), 
           alpha = 0.8, size=1.1, color="black")+
  annotate('segment',x=-126.35, y=50.27, xend=-126.725, yend=50.42, arrow=arrow(length = unit(0.04, "npc")), 
           alpha = 0.8, size=1.1, color="black")
smallermap

## make the one plot inset with the other
insetmap <- ggdraw()+
  draw_plot(smallermap) + 
  draw_plot(biggermap, x=0.1, y=0.1, width=0.52, height=0.3) 
insetmap



############################## new models with no region effect

## so now we're going to re-run the models with the 1800-fish dataset, and this set of models is
## going to be the same but excluidng the region effect
mainlice$year <- as.factor(mainlice$year);mainlice$collection <- as.factor(mainlice$collection)
## First run the models

##leps
lepmodnull3 <- glmmTMB(all.leps ~ 1 + (1|collection), 
                        data = mainlice, family=nbinom2)

lepmod.sp3 <- glmmTMB(all.leps ~ spp - 1 + (1|collection), 
                       data = mainlice, family=nbinom2)
#2
lepmod.yr3 <- glmmTMB(all.leps ~ year - 1 + (1|collection), 
                       data = mainlice, family=nbinom2)
#3

lepmod.spyr3 <- glmmTMB(all.leps ~ spp + year - 1 + (1|collection), 
                         data = mainlice, family=nbinom2)

##cals
calmodnull3 <- glmmTMB(all.cal ~ 1 + (1|collection), 
                        data = mainlice, family=nbinom2)
#1
calmod.sp3 <- glmmTMB(all.cal ~ spp - 1 + (1|collection), 
                       data = mainlice, family=nbinom2)
#2
calmod.yr3 <- glmmTMB(all.cal ~ year - 1 + (1|collection), 
                       data = mainlice, family=nbinom2)
#3
calmod.spyr3 <- glmmTMB(all.cal ~ spp + year - 1 + (1|collection), 
                         data = mainlice, family=nbinom2)

## Call the Summaries & AICs to report in a table in the doc
summary(lepmodnull3)
summary(lepmod.sp3)
summary(lepmod.yr3)
summary(lepmod.spyr3)
summary(calmodnull3)
summary(calmod.sp3)
summary(calmod.yr3)
summary(calmod.spyr3)

AICtab(lepmod.spyr3,lepmodnull3)
AICtab(lepmod.spyr3,lepmod.sp3)
AICtab(lepmod.spyr3,lepmod.yr3)
AICtab(calmod.spyr3,calmodnull3)
AICtab(calmod.spyr3,calmod.sp3)
AICtab(calmod.spyr3,calmod.yr3)

## Use the 'ggeffects' package to get our estimates here

calspeffects <- ggpredict(calmod.spyr3, terms = c('spp', 'year'))
lepspeffects <- ggpredict(lepmod.spyr3, terms = c('spp', 'year'))

## Take the estimated values etc. and use them to make a bunch of lists that we can turn into dfs to make the plots
# leps
leps3coeffs2015 <- lepspeffects %>% filter(group == '2015') %>% select(., predicted)
leps3coeffs2016 <- lepspeffects %>% filter(group == '2016') %>% select(., predicted)
leps3coeffs2017 <- lepspeffects %>% filter(group == '2017') %>% select(., predicted)
leps3coeffs2018 <- lepspeffects %>% filter(group == '2018') %>% select(., predicted)

upleps3CIs2015 <- lepspeffects %>% filter(group == '2015') %>% select(., conf.high)
upleps3CIs2016 <- lepspeffects %>% filter(group == '2016') %>% select(., conf.high)
upleps3CIs2017 <- lepspeffects %>% filter(group == '2017') %>% select(., conf.high)
upleps3CIs2018 <- lepspeffects %>% filter(group == '2018') %>% select(., conf.high)

loleps3CIs2015 <- lepspeffects %>% filter(group == '2015') %>% select(., conf.low)
loleps3CIs2016 <- lepspeffects %>% filter(group == '2016') %>% select(., conf.low)
loleps3CIs2017 <- lepspeffects %>% filter(group == '2017') %>% select(., conf.low)
loleps3CIs2018 <- lepspeffects %>% filter(group == '2018') %>% select(., conf.low)

# cals
cal3coeffs2015 <- calspeffects %>% filter(group == '2015') %>% select(., predicted)
cal3coeffs2016 <- calspeffects %>% filter(group == '2016') %>% select(., predicted)
cal3coeffs2017 <- calspeffects %>% filter(group == '2017') %>% select(., predicted)
cal3coeffs2018 <- calspeffects %>% filter(group == '2018') %>% select(., predicted)

upcal3CIs2015 <- calspeffects %>% filter(group == '2015') %>% select(., conf.high)
upcal3CIs2016 <- calspeffects %>% filter(group == '2016') %>% select(., conf.high)
upcal3CIs2017 <- calspeffects %>% filter(group == '2017') %>% select(., conf.high)
upcal3CIs2018 <- calspeffects %>% filter(group == '2018') %>% select(., conf.high)

local3CIs2015 <- calspeffects %>% filter(group == '2015') %>% select(., conf.low)
local3CIs2016 <- calspeffects %>% filter(group == '2016') %>% select(., conf.low)
local3CIs2017 <- calspeffects %>% filter(group == '2017') %>% select(., conf.low)
local3CIs2018 <- calspeffects %>% filter(group == '2018') %>% select(., conf.low)

sal <- c("CU","PI","SO")
yr2015 <- c('2015', '2015','2015')
yr2016 <- c('2016', '2016','2016')
yr2017 <- c('2017', '2017','2017')
yr2018 <- c('2018', '2018','2018')
licespC <- c('cal','cal', 'cal')
licespL <- c('lep', 'lep', 'lep')

## make the lists into dfs

cal32015 <- rename(cbind(cal3coeffs2015,upcal3CIs2015,local3CIs2015,(data.frame(sal,yr2015,licespC))), 
                  coeffs = predicted, upCI = conf.high, loCI = conf.low, yr = yr2015, lice = licespC)
cal32016 <- rename(cbind(cal3coeffs2016,upcal3CIs2016,local3CIs2016,(data.frame(sal,yr2016,licespC))), 
                   coeffs = predicted, upCI = conf.high, loCI = conf.low, yr = yr2016, lice = licespC) 
cal32017 <- rename(cbind(cal3coeffs2017, upcal3CIs2017,local3CIs2017,(data.frame(sal,yr2017,licespC))), 
                   coeffs = predicted, upCI = conf.high, loCI = conf.low, yr = yr2017, lice = licespC)
cal32018 <- rename(cbind(cal3coeffs2018,upcal3CIs2018,local3CIs2018,(data.frame(sal,yr2018,licespC))), 
                   coeffs = predicted, upCI = conf.high, loCI = conf.low, yr = yr2018, lice = licespC)

calall3 <- rbind(cal32015,cal32016,cal32017,cal32018)

lep32015 <- rename(cbind(leps3coeffs2015,upleps3CIs2015,loleps3CIs2015,(data.frame(sal,yr2015,licespL))), 
                  coeffs = predicted, upCI = conf.high, loCI = conf.low, yr = yr2015,lice = licespL)
lep32016 <- rename(cbind(leps3coeffs2016,upleps3CIs2016,loleps3CIs2016,(data.frame(sal,yr2016,licespL))), 
                  coeffs = predicted, upCI = conf.high, loCI = conf.low, yr = yr2016,lice = licespL) 
lep32017 <- rename(cbind(leps3coeffs2017,upleps3CIs2017,loleps3CIs2017,(data.frame(sal,yr2017,licespL))), 
                  coeffs = predicted, upCI = conf.high, loCI = conf.low, yr = yr2017,lice = licespL)
lep32018 <- rename(cbind(leps3coeffs2018,upleps3CIs2018,loleps3CIs2018,(data.frame(sal,yr2018,licespL))), 
                  coeffs = predicted, upCI = conf.high, loCI = conf.low, yr = yr2018,lice = licespL)

lepsall3 <- rbind(lep32015,lep32016,lep32017,lep32018)

## Make the plots

leg_title <- 'Salmon Species'
library(ggplot2)
leps3fullmodplot <- lepsall3 %>% 
  group_by(., yr,sal) %>% 
  ggplot(aes(x = sal, y = coeffs, colour = sal)) +
  geom_errorbar(aes(ymin=loCI, ymax = upCI,width = 0), colour = 'Black')+
  geom_point(size = 4) +
  facet_wrap(~yr,nrow=1,strip.position = "bottom")+
  theme(strip.background = element_blank(), strip.placement = "outside") + 
  scale_color_manual(leg_title,values=c('seagreen2', 'hotpink1', 'steelblue2')) +
  labs(title = "L. salmonis Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish')
leps3fullmodplot
cal3fullmodplot <- calall3 %>% 
  group_by(., yr,sal) %>% 
  ggplot(aes(x = sal, y = coeffs, colour = sal)) +
  geom_errorbar(aes(ymin=loCI, ymax = upCI,width = 0), colour = 'Black')+
  geom_point(size = 4) +
  facet_wrap(~yr,nrow=1,strip.position = "bottom")+
  theme(strip.background = element_blank(), strip.placement = "outside") + 
  scale_color_manual(leg_title,values=c('seagreen2', 'hotpink1', 'steelblue2'))+
  labs(title = "C. clemensi Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish')
cal3fullmodplot #export 900x550

## Put both on the same plot with a new dataframe

alllice3forplot <- rbind(lep32015,lep32016,lep32017,lep32018,cal32015,cal32016,cal32017,cal32018)
#new plot
bothfull3modplot <- alllice3forplot %>% 
  group_by(., yr,sal,lice) %>% 
  ggplot(aes(x=sal, y = coeffs, colour = sal, shape = lice)) +
  scale_shape_manual(values = c(17,15),labels = c('L. salmonis', 'C. clemensi'))+
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~yr, nrow=1, strip.position = 'bottom')+
  theme(strip.background = element_blank(),strip.placement = 'outside') +
  scale_color_manual(leg_title,values=c('seagreen2', 'hotpink1', 'steelblue2'))+
  labs(title = "Lice Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish',shape = 'Lice Species')+
  guides(shape = guide_legend(override.aes = list(shape = c(24,22)), type = 'b'))
bothfull3modplot #export 900x550

################################## Region level models

## so we are going to tease apart the effects of the different regions using the bigger dataset with the 
## region level in it. We'll do a few operations on the df to get some columns we'll need
regionlice <- read.csv('Hakai_lice_data_all_fish_CB_edits.csv')

# #add in the summed lice columns
# regionlice <- regionlice %>%
#     rowwise() %>%
#     mutate(all.cal = sum(c(cal.mot.notgf,cal.gf), na.rm = TRUE))
# regionlice <- regionlice %>%
#     rowwise() %>%
#     mutate(all.leps = sum(c(lep.pam,lep.paf,lep.am,lep.af,lep.gf,lep.mot.unid.notgf), na.rm = TRUE))
# 
# #add in the site region column
# regionlice <- regionlice %>%
#   mutate(site.region = site.id)
# regionlice$site.region<- substr(regionlice$site.region, 0, 1)
# 
# #add a column for week in the year
# regionlice <- regionlice %>% 
#   mutate(week = date)
# regionlice$week <- strftime(regionlice$week, format = "%V")
# 
# #now add the year in 
# regionlice <- regionlice %>%
#   mutate(year = date)
# regionlice$year <- year(regionlice$year)
# # 
# write.csv(regionlice, file = "Hakai_lice_data_all_fish_CB_edits.csv")

## now we can write the models - we'll write one for each fish species


#now lets do it between all three species, by making some sub-dfs first
regionlice$week <- as.factor(regionlice$week); regionlice$year <- as.factor(regionlice$year)
chum.region <- regionlice %>% 
  filter(spp == 'CU')
pink.region <- regionlice %>% 
  filter(spp == 'PI')
sock.region <- regionlice %>% 
  filter(spp == 'SO')

#now the models 
chumrmod.calnbnull <- glmmTMB(all.cal ~ 1 + (1|week), 
                          data = chum.region, family=nbinom2)
chumrmod.calnbsr <- glmmTMB(all.cal ~ site.region - 1 + (1|week), 
                          data = chum.region, family=nbinom2)
chumrmod.calnbyr <- glmmTMB(all.cal ~ year - 1 + (1|week), 
                          data = chum.region, family=nbinom2)
chumrmod.calnb <- glmmTMB(all.cal ~ site.region + year - 1 + (1|week), 
                           data = chum.region, family=nbinom2)
summary(chumrmod.calnbnull)
summary(chumrmod.calnbsr)
summary(chumrmod.calnbyr)
summary(chumrmod.calnb)

AICtab(chumrmod.calnb,chumrmod.calnbnull)
AICtab(chumrmod.calnb,chumrmod.calnbsr)
AICtab(chumrmod.calnb,chumrmod.calnbyr)

chumrmod.lepsnbnull <- glmmTMB(all.leps ~ 1 + (1|week), 
                              data = chum.region, family=nbinom2)
chumrmod.lepsnbsr <- glmmTMB(all.leps ~ site.region - 1 + (1|week), 
                            data = chum.region, family=nbinom2)
chumrmod.lepsnbyr <- glmmTMB(all.leps ~ year - 1 + (1|week), 
                            data = chum.region, family=nbinom2)
chumrmod.lepsnb <- glmmTMB(all.leps ~ site.region + year - 1 + (1|week), 
                          data = chum.region, family=nbinom2)
summary(chumrmod.lepsnbnull)
summary(chumrmod.lepsnbsr)
summary(chumrmod.lepsnbyr)
summary(chumrmod.lepsnb)

AICtab(chumrmod.lepsnb,chumrmod.lepsnbnull)
AICtab(chumrmod.lepsnb,chumrmod.lepsnbsr)
AICtab(chumrmod.lepsnb,chumrmod.lepsnbyr)

pinkrmod.calnbnull <- glmmTMB(all.cal ~ 1  + (1|week), 
                           data = pink.region, family=nbinom2)
pinkrmod.calnbsr <- glmmTMB(all.cal ~ site.region - 1  + (1|week), 
                           data = pink.region, family=nbinom2)
pinkrmod.calnbyr <- glmmTMB(all.cal ~ year - 1  + (1|week), 
                           data = pink.region, family=nbinom2)
pinkrmod.calnb <- glmmTMB(all.cal ~ site.region + year - 1  + (1|week), 
                         data = pink.region, family=nbinom2)
summary(pinkrmod.calnbnull)
summary(pinkrmod.calnbsr)
summary(pinkrmod.calnbyr)
summary(pinkrmod.calnb)

AICtab(pinkrmod.calnb,pinkrmod.calnbnull)
AICtab(pinkrmod.calnb,pinkrmod.calnbsr)
AICtab(pinkrmod.calnb,pinkrmod.calnbyr)

pinkrmod.lepsnbnull <- glmmTMB(all.leps ~ 1 + (1|week), 
                            data = pink.region, family=nbinom2)
pinkrmod.lepsnbsr <- glmmTMB(all.leps ~ site.region - 1 + (1|week), 
                            data = pink.region, family=nbinom2)
pinkrmod.lepsnbyr <- glmmTMB(all.leps ~ year - 1 + (1|week), 
                            data = pink.region, family=nbinom2)
pinkrmod.lepsnb <- glmmTMB(all.leps ~ site.region + year - 1 + (1|week), 
                          data = pink.region, family=nbinom2)
summary(pinkrmod.lepsnbnull)
summary(pinkrmod.lepsnbsr)
summary(pinkrmod.lepsnbyr)
summary(pinkrmod.lepsnb)

AICtab(pinkrmod.lepsnb,pinkrmod.lepsnbnull)
AICtab(pinkrmod.lepsnb,pinkrmod.lepsnbsr)
AICtab(pinkrmod.lepsnb,pinkrmod.lepsnbyr)

sockrmod.calnbnull <- glmmTMB(all.cal ~ 1 + (1|week), 
                          data = sock.region, family=nbinom2)
sockrmod.calnbsr <- glmmTMB(all.cal ~ site.region - 1 + (1|week), 
                          data = sock.region, family=nbinom2)
sockrmod.calnbyr <- glmmTMB(all.cal ~ year - 1 + (1|week), 
                          data = sock.region, family=nbinom2)
sockrmod.calnb <- glmmTMB(all.cal ~ site.region + year - 1 + (1|week), 
                         data = sock.region, family=nbinom2)
summary(sockrmod.calnbnull)
summary(sockrmod.calnbsr)
summary(sockrmod.calnbyr)
summary(sockrmod.calnb)

AICtab(sockrmod.calnb,sockrmod.calnbnull)
AICtab(sockrmod.calnb,sockrmod.calnbsr)
AICtab(sockrmod.calnb,sockrmod.calnbyr)

sockrmod.lepsnbnull <- glmmTMB(all.leps ~ 1 + (1|week), 
                            data = sock.region, family=nbinom2)
sockrmod.lepsnbsr <- glmmTMB(all.leps ~ site.region - 1 + (1|week), 
                            data = sock.region, family=nbinom2)
sockrmod.lepsnbyr <- glmmTMB(all.leps ~ year - 1 + (1|week), 
                            data = sock.region, family=nbinom2)
sockrmod.lepsnb <- glmmTMB(all.leps ~ site.region + year - 1 + (1|week), 
                          data = sock.region, family=nbinom2)
summary(sockrmod.lepsnbnull)
summary(sockrmod.lepsnbsr)
summary(sockrmod.lepsnbyr)
summary(sockrmod.lepsnb)

AICtab(sockrmod.lepsnbsr,sockrmod.lepsnbnull)
AICtab(sockrmod.lepsnbsr,sockrmod.lepsnb)
AICtab(sockrmod.lepsnbsr,sockrmod.lepsnbyr)

#use the ggeffects package again to get the estimates that will be put inside the df for plotting
chumcalspeffects <- ggpredict(chumrmod.calnb, terms = c('site.region', 'year'))
chumlepspeffects <- ggpredict(chumrmod.lepsnb,terms = c('site.region', 'year'))
pinkcalspeffects <- ggpredict(pinkrmod.calnb, terms = c('site.region', 'year'))
pinklepspeffects <- ggpredict(pinkrmod.lepsnb,terms = c('site.region', 'year'))
sockcalspeffects <- ggpredict(sockrmod.calnb, terms = c('site.region', 'year'))
socklepspeffects <- ggpredict(sockrmod.lepsnbsr,terms = 'site.region')
socklepspeffects1 <- ggpredict(sockrmod.lepsnb,terms = c('site.region', 'year'))

#make a df to store the estimated values in

chumcalcoeffsnb <- chumcalspeffects %>% select(., predicted)
chumcalupCInb <- chumcalspeffects %>% select(., conf.high)
chumcalloCInb <- chumcalspeffects %>% select(., conf.low)
sal1 <- c('Chum', 'Chum','Chum', 'Chum','Chum', 'Chum','Chum', 'Chum')
sal2 <- c('Pink', 'Pink', 'Pink', 'Pink', 'Pink', 'Pink', 'Pink', 'Pink')
sal3 <- c('Sockeye', 'Sockeye', 'Sockeye', 'Sockeye', 'Sockeye', 'Sockeye', 'Sockeye', 'Sockeye')
year <- c('2015', '2016', '2017', '2018', '2015', '2016','2017', '2018')
Region<- c('DI','DI','DI','DI','JS','JS','JS', 'JS')
lice1 <- c('C. clemensi', 'C. clemensi','C. clemensi', 'C. clemensi',
          'C. clemensi', 'C. clemensi','C. clemensi', 'C. clemensi')
lice2 <- c('L. salmonis','L. salmonis','L. salmonis','L. salmonis',
           'L. salmonis','L. salmonis','L. salmonis','L. salmonis')
chumsregioncalnb <- rename(cbind(chumcalcoeffsnb,chumcalupCInb,chumcalloCInb,(data.frame(sal1,year,Region,lice1))),
                         coeffs = predicted, upCI = conf.high, loCI = conf.low,
                         lice = lice1, sal = sal1)

chumlepcoeffsnb <- chumlepspeffects %>% select(., predicted)
chumlepupCInb <- chumlepspeffects %>% select(., conf.high)
chumleploCInb <- chumlepspeffects %>% select(., conf.low)
chumsregionlepnb <- rename(cbind(chumlepcoeffsnb,chumlepupCInb,chumleploCInb,(data.frame(sal1,year,Region,lice2))),
                         coeffs = predicted, upCI = conf.high, loCI = conf.low,
                         sal = sal1, lice = lice2)

pinkcalcoeffsnb <- pinkcalspeffects %>% select(., predicted)
pinkcalupCInb <- pinkcalspeffects %>% select(., conf.high)
pinkcalloCInb <- pinkcalspeffects %>% select(., conf.low)
pinkregioncalnb <- rename(cbind(pinkcalcoeffsnb,pinkcalupCInb,pinkcalloCInb,(data.frame(sal2,year,Region,lice1))),
                         coeffs = predicted, upCI = conf.high, loCI = conf.low,
                         sal = sal2, lice = lice1)


pinklepscoeffsnb <- pinklepspeffects %>% select(., predicted)
pinklepsupCInb <- pinklepspeffects %>% select(., conf.high)
pinklepsloCInb <- pinklepspeffects %>% select(., conf.low)
pinkregionlepsnb <- rename(cbind(pinklepscoeffsnb,pinklepsupCInb,pinklepsloCInb,(data.frame(sal2,year,Region,lice2))),
                        coeffs = predicted, upCI = conf.high, loCI =  conf.low,
                        sal = sal2, lice = lice2)


sockcalcoeffsnb <- sockcalspeffects %>% select(., predicted)
sockcalupCInb <- sockcalspeffects %>% select(., conf.high)
sockcalloCInb <- sockcalspeffects %>% select(., conf.low)
sockregioncalnb <- rename(cbind(sockcalcoeffsnb,sockcalupCInb,sockcalloCInb,(data.frame(sal3,year,Region,lice1))),
                         coeffs = predicted, upCI = conf.high, loCI = conf.low,
                         sal = sal3, lice = lice1)

#do both the highest ranked, and the full model just in case
socklepscoeffssr <- socklepspeffects %>% select(., predicted)
socklepsupCIsr <- socklepspeffects %>% select(., conf.high)
socklepsloCIsr <- socklepspeffects %>% select(., conf.low)
sal3sr <- c('Sockeye','Sockeye')
lice2sr <- c('L. salmonis', 'L. salmonis')
Regionsr <- c('Discovery Islands', 'Johnstone Strait')
Regionsr1 <- c('DI', 'JS')
sockregionlepssr <- rename(cbind(socklepscoeffssr,socklepsupCIsr,socklepsloCIsr,(data.frame(sal3sr,Regionsr,lice2sr))),
                          coeffs = predicted, upCI = conf.high, loCI = conf.low,
                          sal = sal3sr, lice = lice2sr, Region = Regionsr)
sockregionlepssr1 <- rename(cbind(socklepscoeffssr,socklepsupCIsr,socklepsloCIsr,(data.frame(sal3sr,Regionsr1,lice2sr))),
                           coeffs = predicted, upCI = conf.high, loCI = conf.low,
                           sal = sal3sr, lice = lice2sr, Region = Regionsr1)
socklepscoeffsnb <- socklepspeffects1 %>% select(., predicted)
socklepsupCInb <- socklepspeffects1 %>% select(., conf.high)
socklepsloCInb <- socklepspeffects1 %>% select(., conf.low)
sockregionlepsnb <- rename(cbind(socklepscoeffsnb,socklepsupCInb,socklepsloCInb,(data.frame(sal3,year,Region,lice2))),
                           coeffs = predicted, upCI = conf.high, loCI = conf.low,
                           sal = sal3, lice = lice2)

regionestbyspchumnb <- rbind(chumsregioncalnb, chumsregionlepnb)
regionestbysppinknb <- rbind(pinkregioncalnb,pinkregionlepsnb)
regionestbyspsocknb <- rbind(sockregioncalnb,sockregionlepsnb)
regionestbyspsockcal <- sockregioncalnb

#make some themes so it all looks nice beside each other
fte_themeSock <- function(){
  color.background = 'white'
  color.grid.major = 'black'
  color.axis.text = 'black'
  color.axis.title = 'black'
  color.title = 'black'
  theme_bw(base_size = 9) + 
    theme(panel.background = element_rect(fill=color.background,color = color.background)) +
    theme(plot.background = element_rect(fill = color.background, color = color.background)) +
    theme(panel.border = element_blank()) +
    theme(panel.grid.major = element_blank()) + 
    theme(panel.grid.minor = element_blank()) + 
    theme(axis.ticks = element_blank()) +
    theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
    theme(axis.text.x = element_text(size = 10, color = color.axis.text)) + 
    theme(axis.text.y = element_text(size = 10, color = color.axis.text)) + 
    theme(axis.title.x = element_text(size = 12, color = color.axis.title, vjust = 0)) +
    theme(axis.title.y = element_text(size = 12, color = color.axis.title, vjust = 1.25)) +
    theme(plot.title = element_text(hjust = 0.5)) +
    theme(axis.line.x = element_line(color="black", size = 0.15),
          axis.line.y = element_line(color="black", size = 0.15)) +
    theme(strip.background = element_blank(),
                  strip.placement = 'outside',
          strip.text = element_text(size = 10))+
    theme(legend.position = 'none')
} 
fte_themeSock2 <- function(){
  color.background = 'white'
  color.grid.major = 'black'
  color.axis.text = 'black'
  color.axis.title = 'black'
  color.title = 'black'
  theme_bw(base_size = 9) + 
    theme(panel.background = element_rect(fill=color.background,color = color.background)) +
    theme(plot.background = element_rect(fill = color.background, color = color.background)) +
    theme(panel.border = element_blank()) +
    theme(panel.grid.major = element_blank()) + 
    theme(panel.grid.minor = element_blank()) + 
    theme(axis.ticks = element_blank()) +
    theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
    theme(axis.text.x = element_text(size = 10, color = color.axis.text)) + 
    theme(axis.text.y = element_text(size = 10, color = color.axis.text)) + 
    theme(axis.title.x = element_text(size = 12, color = color.axis.title, vjust = 0)) +
    theme(axis.title.y = element_text(size = 12, color = color.axis.title, vjust = 1.25)) +
    theme(plot.title = element_text(hjust = 0.5)) +
    theme(axis.line.x = element_line(color="black", size = 0.15),
          axis.line.y = element_line(color="black", size = 0.15)) +
    theme(strip.background = element_blank(),
          strip.placement = 'outside',
          strip.text = element_text(size = 10))+
    theme(legend.position = c(0.9,0.82),
          legend.text = element_text(size = 10),
          legend.title = element_text(size = 10))
} 
fte_themeSock3 <- function(){
  color.background = 'white'
  color.grid.major = 'black'
  color.axis.text = 'black'
  color.axis.title = 'black'
  color.title = 'black'
  theme_bw(base_size = 9) + 
    theme(panel.background = element_rect(fill=color.background,color = color.background)) +
    theme(plot.background = element_rect(fill = color.background, color = color.background)) +
    theme(panel.border = element_blank()) +
    theme(panel.grid.major = element_blank()) + 
    theme(panel.grid.minor = element_blank()) + 
    theme(axis.ticks = element_blank()) +
    theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
    theme(axis.text.x = element_text(size = 10, color = color.axis.text)) + 
    theme(axis.text.y = element_text(size = 10, color = color.axis.text)) + 
    theme(axis.title.x = element_text(size = 12, color = color.axis.title, 
                                      margin= margin(t = 0.7, r = , b = 0, l = 0, unit = "cm"), vjust = 0)) +
    theme(axis.title.y = element_text(size = 12, color = color.axis.title, vjust = 1.25)) +
    theme(plot.title = element_text(hjust = 0.5)) +
    theme(axis.line.x = element_line(color="black", size = 0.15),
          axis.line.y = element_line(color="black", size = 0.15)) +
    theme(strip.background = element_blank(),
          strip.placement = 'outside',
          strip.text = element_text(size = 10))+
    theme(legend.position = 'none')
} 
fte_themePink <- function(){
  color.background = 'white'
  color.grid.major = 'black'
  color.axis.text = 'black'
  color.axis.title = 'black'
  color.title = 'black'
  theme_bw(base_size = 9) + 
    theme(panel.background = element_rect(fill=color.background,color = color.background)) +
    theme(plot.background = element_rect(fill = color.background, color = color.background)) +
    theme(panel.border = element_blank()) +
    theme(panel.grid.major = element_blank()) + 
    theme(panel.grid.minor = element_blank()) + 
    theme(axis.ticks = element_blank()) +
    theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
    theme(axis.text.x = element_text(size = 10, color = color.axis.text)) + 
    theme(axis.text.y = element_blank()) + 
    theme(axis.title.x = element_text(size = 12, color = color.axis.title, vjust = 0)) +
    theme(axis.title.y = element_text(size = 12, color = color.axis.title, vjust = 1.25)) +
    theme(plot.title = element_text(hjust = 0.5)) +
    theme(axis.line.x = element_line(color="black", size = 0.15),
          axis.line.y = element_line(linetype = 'dashed', color = 'grey75')) +
    theme(strip.background = element_blank(),
          strip.placement = 'outside',
          strip.text = element_text(size = 10))+
    theme(legend.position = 'none')
} 
fte_themeChum <- function(){
  color.background = 'white'
  color.grid.major = 'black'
  color.axis.text = 'black'
  color.axis.title = 'black'
  color.title = 'black'
  theme_bw(base_size = 9) + 
    theme(panel.background = element_rect(fill=color.background,color = color.background)) +
    theme(plot.background = element_rect(fill = color.background, color = color.background)) +
    theme(panel.border = element_blank()) +
    theme(panel.grid.major = element_blank()) + 
    theme(panel.grid.minor = element_blank()) + 
    theme(axis.ticks = element_blank()) +
    theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
    theme(axis.text.x = element_text(size = 10, color = color.axis.text)) + 
    theme(axis.text.y = element_blank()) + 
    theme(axis.title.x = element_text(size = 12, color = color.axis.title, vjust = 0)) +
    theme(axis.title.y = element_text(size = 12, color = color.axis.title, vjust = 1.25)) +
    theme(plot.title = element_text(hjust = 0.5)) +
    theme(axis.line.x = element_line(color="black", size = 0.15),
          axis.line.y = element_line(linetype = 'dashed', color = 'grey75')) +
    theme(strip.background = element_blank(),
          strip.placement = 'outside',
          strip.text = element_text(size = 10))+
    theme(legend.position = c(0.8,0.82),
          legend.text = element_text(size = 10),
          legend.title = element_text(size = 10))
} 

#make the plots
regionestbyspplotchumnb <- regionestbyspchumnb %>% 
  group_by(.,lice,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region, shape = lice)) +
  scale_shape_manual(values = c(17,15),labels = c('C. clemensi','L. salmonis'))+
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Chum Salmon",x = '', y = NULL,shape = 'Lice Species')+
  guides(shape = guide_legend(override.aes = list(shape = c(24,22)), type = 'b'))+
  scale_y_continuous(limits = c(0,1.25)) +
  fte_themeChum()
regionestbyspplotchumnb
regionestbyspplotpinknb <- regionestbysppinknb %>% 
  group_by(.,lice,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region, shape = lice)) +
  scale_shape_manual(values = c(17,15),labels = c('C. clemensi','L. salmonis'))+
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  theme(strip.background = element_blank(),strip.placement = 'outside') +
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Pink Salmon", x = 'Year & Region', y = NULL,shape = 'Lice Species')+
  guides(shape = guide_legend(override.aes = list(shape = c(24,22)), type = 'b'))+
  scale_y_continuous(limits = c(0,1.25)) +
  fte_themePink()
regionestbyspplotpinknb
regionestbyspplotsocknb <- regionestbyspsocknb %>% 
  group_by(.,lice,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region, shape = lice)) +
  scale_shape_manual(values = c(17,15),labels = c('C. clemensi','L. salmonis'))+
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  theme(strip.background = element_blank(),strip.placement = 'outside') +
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Sockeye Salmon", x = '', y = 'Average Number of Motile Lice Per Fish',shape = 'Lice Species')+
  guides(shape = guide_legend(override.aes = list(shape = c(24,22)), type = 'b'))+
  scale_y_continuous(limits = c(0,1.25))+
  fte_themeSock()
regionestbyspplotsocknb

regionbothnb <- plot_grid(regionestbyspplotsocknb,regionestbyspplotpinknb,regionestbyspplotchumnb,
                        nrow = 1, labels = NULL, rel_widths = c(1,1,1)) 
regionbothnb

## Now the same but without the leps on sockeye
regionestbyspplotsockcal <- regionestbyspsockcal %>% 
  group_by(.,lice,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region, shape = lice)) +
  scale_shape_manual(values = c(17,15),labels = c('C. clemensi','L. salmonis'))+
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  theme(strip.background = element_blank(),strip.placement = 'outside') +
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Sockeye Salmon", x = '', y = 'Average Number of Motile Lice Per Fish',shape = 'Lice Species')+
  guides(shape = guide_legend(override.aes = list(shape = c(24,22)), type = 'b'))+
  scale_y_continuous(limits = c(0,1.25))+
  fte_themeSock()
regionestbyspplotsockcal

regionbothcalsock <- plot_grid(regionestbyspplotsockcal,regionestbyspplotpinknb,regionestbyspplotchumnb,
                          nrow = 1, labels = NULL, rel_widths = c(1,1,1)) 
regionbothcalsock

## Make the leps only plot (since it's not faceted by years)
sockregionlepssrplot <- sockregionlepssr %>% 
  group_by(., Region) %>% 
  ggplot(aes(x = Region, y = coeffs, colour = Region)) +
  scale_shape_manual(values = c(15), labels = c('L. salmonis')) +
  geom_errorbar(aes(ymin = loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8), colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width = 0.8)) +
  scale_colour_manual(values = c('grey60', 'grey20')) +
  labs(title = 'Sockeye Salmon', x = 'Region', y = 'Average Number of Motile Lice Per Fish') +
  guides(shape = guide_legend(override.aes = list(shape = c(22)), type = 'b')) +
  scale_y_continuous(limits = c(0, 0.05)) +
  fte_themeSock2()
sockregionlepssrplot
#subset the dataframes
regionestbyspchumLEPnb <- regionestbyspchumnb %>% 
  filter(lice == 'L. salmonis')
regionestbyspchumCALnb <- regionestbyspchumnb %>% 
  filter(lice == 'C. clemensi')
regionestbysppinkLEPnb <- regionestbysppinknb %>% 
  filter(lice == 'L. salmonis')
regionestbysppinkCALnb <- regionestbysppinknb %>% 
  filter(lice == 'C. clemensi')
regionestbyspsockLEPnb <- regionestbyspsocknb %>% 
  filter(lice == 'L. salmonis')
regionestbyspsockCALnb <- regionestbyspsocknb %>% 
  filter(lice == 'C. clemensi')

#do lep plots
regionestbyspplotchumLEPnb <- regionestbyspchumLEPnb %>% 
  group_by(.,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region)) +
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Chum Salmon", x = '', y = NULL, Region = c('Discovery Islands', 'Johnstone Strait'))+
  scale_y_continuous(limits = c(0,0.62)) +
  fte_themeChum()
regionestbyspplotchumLEPnb
regionestbyspplotpinkLEPnb <- regionestbysppinkLEPnb %>% 
  group_by(.,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region)) +
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Pink Salmon", x = 'Year and Region', y = NULL)+
  scale_y_continuous(limits = c(0,0.62)) +
  fte_themePink()
regionestbyspplotpinkLEPnb
#leps sockeye plot that uses non-year faceted values
sockregionlepssrplot1 <- sockregionlepssr1 %>% 
  group_by(., Region) %>% 
  ggplot(aes(x = Region, y = coeffs, colour = Region)) +
  scale_shape_manual(values = c(15), labels = c('L. salmonis')) +
  geom_errorbar(aes(ymin = loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8), colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width = 0.8)) +
  scale_colour_manual(values = c('grey60', 'grey20')) +
  labs(title = 'Sockeye Salmon', x = '', y = 'Average Number of Motile L. salmonis Lice Per Fish') +
  guides(shape = guide_legend(override.aes = list(shape = c(22)), type = 'b')) +
  scale_y_continuous(limits = c(0, 0.62)) +
  fte_themeSock3()
sockregionlepssrplot1
#leps sockeye plot that uses year-faceted values
regionestbyspplotsockLEPnb <- regionestbyspsockLEPnb %>%
  group_by(.,Region,year) %>%
  ggplot(aes(x=Region, y = coeffs, colour = Region)) +
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  theme(strip.background = element_blank(),strip.placement = 'outside') +
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Sockeye Salmon", x = '', y = 'Average Number of Motile L. salmonis Lice Per Fish')+
  scale_y_continuous(limits = c(0,0.62))+
  fte_themeSock3()
regionestbyspplotsockLEPnb

### option 1
regionLEPnb <- plot_grid(sockregionlepssrplot1,regionestbyspplotpinkLEPnb,regionestbyspplotchumLEPnb, 
                        nrow = 1, labels = NULL) 
regionLEPnb #print 800x450 ---- this option has the sockeye column different



#do Cal plots
regionestbyspplotchumCALnb <- regionestbyspchumCALnb %>% 
  group_by(.,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region)) +
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Chum Salmon", x = '', y = NULL, Region = c('Discovery Islands', 'Johnstone Strait'))+
  scale_y_continuous(limits = c(0,1.25)) +
  fte_themeChum()
regionestbyspplotchumCALnb
regionestbyspplotpinkCALnb <- regionestbysppinkCALnb %>% 
  group_by(.,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region)) +
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Pink Salmon", x = 'Year and Region', y = NULL)+
  scale_y_continuous(limits = c(0,1.25)) +
  fte_themePink()
regionestbyspplotpinkCALnb
regionestbyspplotsockCALnb <- regionestbyspsockCALnb %>% 
  group_by(.,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region)) +
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  theme(strip.background = element_blank(),strip.placement = 'outside') +
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Sockeye Salmon", x = '', y = 'Average Number of Motile C. clemensi Lice Per Fish')+
  scale_y_continuous(limits = c(0,1.25))+
  fte_themeSock()
regionestbyspplotsockCALnb

regionCALnb <- plot_grid(regionestbyspplotsockCALnb,regionestbyspplotpinkCALnb,regionestbyspplotchumCALnb,
                           nrow = 1, labels = NULL) 
regionCALnb #export 800x450



################################## Bootstrapping

## Goal here is to take the region-level lice dataset and plot the mean and distribution
## of the data themselves using a bootstrap

#1. Create reduced dataframes that includes only the year, region and species combination 
#that I want
#2. Run a simulation, sampling with replacement from that database, with random sampling
#at both levels, i.e. collection and fish (so it randomly picks a collection (with replacement), 
#and then randomly samples x times where x is the number of fish in that collection (with replacement))
#calculates the mean of those x samples, stores that mean, and then randomly resamples a collection etc. 
# 3. When it's done it'll be 10,000 calculations of the mean - then we can take the medain of that 
#distribution, and get the confidence intervals from the 2.5% and 97.5% quantiles, or the 250th, 
#5000th, and 9750th measurements. 

## so first let's make all the reduced dataframes

#make sure to get all the combos included
sock2015D <- regionlice %>% filter(spp == 'SO' & year == '2015' & site.region == 'D')
sock2015J <- regionlice %>% filter(spp == 'SO' & year == '2015' & site.region == 'J')
sock2016D <- regionlice %>% filter(spp == 'SO' & year == '2016' & site.region == 'D')
sock2016J <- regionlice %>% filter(spp == 'SO' & year == '2016' & site.region == 'J')
sock2017D <- regionlice %>% filter(spp == 'SO' & year == '2017' & site.region == 'D')
sock2017J <- regionlice %>% filter(spp == 'SO' & year == '2017' & site.region == 'J')
sock2018D <- regionlice %>% filter(spp == 'SO' & year == '2018' & site.region == 'D')
sock2018J <- regionlice %>% filter(spp == 'SO' & year == '2018' & site.region == 'J')

chum2015D <- regionlice %>% filter(spp == 'CU' & year == '2015' & site.region == 'D')
chum2015J <- regionlice %>% filter(spp == 'CU' & year == '2015' & site.region == 'J')
chum2016D <- regionlice %>% filter(spp == 'CU' & year == '2016' & site.region == 'D')
chum2016J <- regionlice %>% filter(spp == 'CU' & year == '2016' & site.region == 'J')
chum2017D <- regionlice %>% filter(spp == 'CU' & year == '2017' & site.region == 'D')
chum2017J <- regionlice %>% filter(spp == 'CU' & year == '2017' & site.region == 'J')
chum2018D <- regionlice %>% filter(spp == 'CU' & year == '2018' & site.region == 'D')
chum2018J <- regionlice %>% filter(spp == 'CU' & year == '2018' & site.region == 'J')

pink2015D <- regionlice %>% filter(spp == 'PI' & year == '2015' & site.region == 'D')
pink2015J <- regionlice %>% filter(spp == 'PI' & year == '2015' & site.region == 'J')
pink2016D <- regionlice %>% filter(spp == 'PI' & year == '2016' & site.region == 'D')
pink2016J <- regionlice %>% filter(spp == 'PI' & year == '2016' & site.region == 'J')
pink2017D <- regionlice %>% filter(spp == 'PI' & year == '2017' & site.region == 'D')
pink2017J <- regionlice %>% filter(spp == 'PI' & year == '2017' & site.region == 'J')
pink2018D <- regionlice %>% filter(spp == 'PI' & year == '2018' & site.region == 'D')
pink2018J <- regionlice %>% filter(spp == 'PI' & year == '2018' & site.region == 'J')

#add collection numbers to each one

library(data.table)
setDT(sock2015D)[, Collection := .GRP, .(date, site.id)]
setDT(sock2015J)[, Collection := .GRP, .(date, site.id)]
setDT(sock2016D)[, Collection := .GRP, .(date, site.id)]
setDT(sock2016J)[, Collection := .GRP, .(date, site.id)]
setDT(sock2017D)[, Collection := .GRP, .(date, site.id)]
setDT(sock2017J)[, Collection := .GRP, .(date, site.id)]
setDT(sock2018D)[, Collection := .GRP, .(date, site.id)]
setDT(sock2018J)[, Collection := .GRP, .(date, site.id)]

setDT(chum2015D)[, Collection := .GRP, .(date, site.id)]
setDT(chum2015J)[, Collection := .GRP, .(date, site.id)]
setDT(chum2016D)[, Collection := .GRP, .(date, site.id)]
setDT(chum2016J)[, Collection := .GRP, .(date, site.id)]
setDT(chum2017D)[, Collection := .GRP, .(date, site.id)]
setDT(chum2017J)[, Collection := .GRP, .(date, site.id)]
setDT(chum2018D)[, Collection := .GRP, .(date, site.id)]
setDT(chum2018J)[, Collection := .GRP, .(date, site.id)]

setDT(pink2015D)[, Collection := .GRP, .(date, site.id)]
setDT(pink2015J)[, Collection := .GRP, .(date, site.id)]
setDT(pink2016D)[, Collection := .GRP, .(date, site.id)]
setDT(pink2016J)[, Collection := .GRP, .(date, site.id)]
setDT(pink2017D)[, Collection := .GRP, .(date, site.id)]
setDT(pink2017J)[, Collection := .GRP, .(date, site.id)]
setDT(pink2018D)[, Collection := .GRP, .(date, site.id)]
setDT(pink2018J)[, Collection := .GRP, .(date, site.id)]

#now use bootstraps on new, compact tibble to sample by collection
set.seed(0001)

#let's do Caligus First

#first, make empty dataframes for the results
calboot.sock2015D <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.sock2015D) <- c('Collection', 'Caligus')
calboot.sock2015J <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.sock2015J) <- c('Collection', 'Caligus')
calboot.sock2016D <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.sock2016D) <- c('Collection', 'Caligus')
calboot.sock2016J <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.sock2016J) <- c('Collection', 'Caligus')
calboot.sock2017D <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.sock2017D) <- c('Collection', 'Caligus')
calboot.sock2017J <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.sock2017J) <- c('Collection', 'Caligus')
calboot.sock2018D <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.sock2018D) <- c('Collection', 'Caligus')
calboot.sock2018J <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.sock2018J) <- c('Collection', 'Caligus')

calboot.chum2015D <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.chum2015D) <- c('Collection', 'Caligus')
calboot.chum2015J <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.chum2015J) <- c('Collection', 'Caligus')
calboot.chum2016D <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.chum2016D) <- c('Collection', 'Caligus')
calboot.chum2016J <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.chum2016J) <- c('Collection', 'Caligus')
calboot.chum2017D <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.chum2017D) <- c('Collection', 'Caligus')
calboot.chum2017J <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.chum2017J) <- c('Collection', 'Caligus')
calboot.chum2018D <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.chum2018D) <- c('Collection', 'Caligus')
calboot.chum2018J <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.chum2018J) <- c('Collection', 'Caligus')

calboot.pink2015D <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.pink2015D) <- c('Collection', 'Caligus')
calboot.pink2015J <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.pink2015J) <- c('Collection', 'Caligus')
calboot.pink2016D <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.pink2016D) <- c('Collection', 'Caligus')
calboot.pink2016J <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.pink2016J) <- c('Collection', 'Caligus')
calboot.pink2017D <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.pink2017D) <- c('Collection', 'Caligus')
calboot.pink2017J <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.pink2017J) <- c('Collection', 'Caligus')
calboot.pink2018D <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.pink2018D) <- c('Collection', 'Caligus')
calboot.pink2018J <- data.frame(nrow = 10000, ncol = 2); colnames(calboot.pink2018J) <- c('Collection', 'Caligus')

#we'll use a loop as well as dplyr::sample_n()
#sockeye
for(i in 1:10000) {
  b1 <- sample(sock2015D$Collection, size = 1)
  
  res <- sock2015D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.sock2015D[i,] <- res[]
}  
for(i in 1:10000) {
  b1 <- sample(sock2015J$Collection, size = 1)
  
  res <- sock2015J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.sock2015J[i,] <- res[]
}  
for(i in 1:10000) {
  b1 <- sample(sock2016D$Collection, size = 1)
  
  res <- sock2016D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.sock2016D[i,] <- res[]
}  
for(i in 1:10000) {
  b1 <- sample(sock2016J$Collection, size = 1)
  
  res <- sock2016J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.sock2016J[i,] <- res[]
}  
for(i in 1:10000) {
  b1 <- sample(sock2017D$Collection, size = 1)
  
  res <- sock2017D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.sock2017D[i,] <- res[]
} 
for(i in 1:10000) {
  b1 <- sample(sock2017J$Collection, size = 1)
  
  res <- sock2017J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.sock2017J[i,] <- res[]
} 
for(i in 1:10000) {
  b1 <- sample(sock2018D$Collection, size = 1)
  
  res <- sock2018D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.sock2018D[i,] <- res[]
} 
for(i in 1:10000) {
  b1 <- sample(sock2018J$Collection, size = 1)
  
  res <- sock2018J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.sock2018J[i,] <- res[]
}

#chum
for(i in 1:10000) {
  b1 <- sample(chum2015D$Collection, size = 1)
  
  res <- chum2015D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.chum2015D[i,] <- res[]
}  
for(i in 1:10000) {
  b1 <- sample(chum2015J$Collection, size = 1)
  
  res <- chum2015J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.chum2015J[i,] <- res[]
}  
for(i in 1:10000) {
  b1 <- sample(chum2016D$Collection, size = 1)
  
  res <- chum2016D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.chum2016D[i,] <- res[]
}  
for(i in 1:10000) {
  b1 <- sample(chum2016J$Collection, size = 1)
  
  res <- chum2016J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.chum2016J[i,] <- res[]
}  
for(i in 1:10000) {
  b1 <- sample(chum2017D$Collection, size = 1)
  
  res <- chum2017D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.chum2017D[i,] <- res[]
} 
for(i in 1:10000) {
  b1 <- sample(chum2017J$Collection, size = 1)
  
  res <- chum2017J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.chum2017J[i,] <- res[]
} 
for(i in 1:10000) {
  b1 <- sample(chum2018D$Collection, size = 1)
  
  res <- chum2018D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.chum2018D[i,] <- res[]
} 
for(i in 1:10000) {
  b1 <- sample(chum2018J$Collection, size = 1)
  
  res <- chum2018J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.chum2018J[i,] <- res[]
} 

#pink
for(i in 1:10000) {
  b1 <- sample(pink2015D$Collection, size = 1)
  
  res <- pink2015D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.pink2015D[i,] <- res[]
}  
for(i in 1:10000) {
  b1 <- sample(pink2015J$Collection, size = 1)
  
  res <- pink2015J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.pink2015J[i,] <- res[]
}  
for(i in 1:10000) {
  b1 <- sample(pink2016D$Collection, size = 1)
  
  res <- pink2016D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.pink2016D[i,] <- res[]
}  
for(i in 1:10000) {
  b1 <- sample(pink2016J$Collection, size = 1)
  
  res <- pink2016J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.pink2016J[i,] <- res[]
}  
for(i in 1:10000) {
  b1 <- sample(pink2017D$Collection, size = 1)
  
  res <- pink2017D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.pink2017D[i,] <- res[]
} 
for(i in 1:10000) {
  b1 <- sample(pink2017J$Collection, size = 1)
  
  res <- pink2017J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.pink2017J[i,] <- res[]
} 
for(i in 1:10000) {
  b1 <- sample(pink2018D$Collection, size = 1)
  
  res <- pink2018D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.pink2018D[i,] <- res[]
} 
for(i in 1:10000) {
  b1 <- sample(pink2018J$Collection, size = 1)
  
  res <- pink2018J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(caligus = mean(all.cal))
  
  calboot.pink2018J[i,] <- res[]
}

#Now the leps

#first, make empty dataframes for the results
lepboot.sock2015D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.sock2015D) <- c('Collection', 'Leps')
lepboot.sock2015J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.sock2015J) <- c('Collection', 'Leps')
lepboot.sock2016D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.sock2016D) <- c('Collection', 'Leps')
lepboot.sock2016J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.sock2016J) <- c('Collection', 'Leps')
lepboot.sock2017D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.sock2017D) <- c('Collection', 'Leps')
lepboot.sock2017J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.sock2017J) <- c('Collection', 'Leps')
lepboot.sock2018D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.sock2018D) <- c('Collection', 'Leps')
lepboot.sock2018J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.sock2018J) <- c('Collection', 'Leps')

lepboot.chum2015D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.chum2015D) <- c('Collection', 'Leps')
lepboot.chum2015J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.chum2015J) <- c('Collection', 'Leps')
lepboot.chum2016D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.chum2016D) <- c('Collection', 'Leps')
lepboot.chum2016J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.chum2016J) <- c('Collection', 'Leps')
lepboot.chum2017D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.chum2017D) <- c('Collection', 'Leps')
lepboot.chum2017J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.chum2017J) <- c('Collection', 'Leps')
lepboot.chum2018D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.chum2018D) <- c('Collection', 'Leps')
lepboot.chum2018J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.chum2018J) <- c('Collection', 'Leps')

lepboot.pink2015D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.pink2015D) <- c('Collection', 'Leps')
lepboot.pink2015J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.pink2015J) <- c('Collection', 'Leps')
lepboot.pink2016D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.pink2016D) <- c('Collection', 'Leps')
lepboot.pink2016J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.pink2016J) <- c('Collection', 'Leps')
lepboot.pink2017D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.pink2017D) <- c('Collection', 'Leps')
lepboot.pink2017J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.pink2017J) <- c('Collection', 'Leps')
lepboot.pink2018D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.pink2018D) <- c('Collection', 'Leps')
lepboot.pink2018J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.pink2018J) <- c('Collection', 'Leps')

#we'll use a loop as well as dplyr::sample_n()Leps
#sockeye
pb = txtProgressBar(min = 0, max = 10000, initial = 0) 
for(i in 1:10000) {
  b1 <- sample(sock2015D$Collection, size = 1)
  
  res <- sock2015D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.sock2015D[i,] <- res[]
  setTxtProgressBar(pb,i)
}  
for(i in 1:10000) {
  b1 <- sample(sock2015J$Collection, size = 1)
  
  res <- sock2015J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.sock2015J[i,] <- res[]
  setTxtProgressBar(pb,i)
}  
for(i in 1:10000) {
  b1 <- sample(sock2016D$Collection, size = 1)
  
  res <- sock2016D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.sock2016D[i,] <- res[]
  setTxtProgressBar(pb,i)
}  
for(i in 1:10000) {
  b1 <- sample(sock2016J$Collection, size = 1)
  
  res <- sock2016J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.sock2016J[i,] <- res[]
  setTxtProgressBar(pb,i)
}  
for(i in 1:10000) {
  b1 <- sample(sock2017D$Collection, size = 1)
  
  res <- sock2017D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.sock2017D[i,] <- res[]
  setTxtProgressBar(pb,i)
} 
for(i in 1:10000) {
  b1 <- sample(sock2017J$Collection, size = 1)
  
  res <- sock2017J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.sock2017J[i,] <- res[]
  setTxtProgressBar(pb,i)
} 
for(i in 1:10000) {
  b1 <- sample(sock2018D$Collection, size = 1)
  
  res <- sock2018D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.sock2018D[i,] <- res[]
  setTxtProgressBar(pb,i)
} 
for(i in 1:10000) {
  b1 <- sample(sock2018J$Collection, size = 1)
  
  res <- sock2018J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.sock2018J[i,] <- res[]
  setTxtProgressBar(pb,i)
}

#chum
for(i in 1:10000) {
  b1 <- sample(chum2015D$Collection, size = 1)
  
  res <- chum2015D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.chum2015D[i,] <- res[]
  setTxtProgressBar(pb,i)
}  
for(i in 1:10000) {
  b1 <- sample(chum2015J$Collection, size = 1)
  
  res <- chum2015J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.chum2015J[i,] <- res[]
  setTxtProgressBar(pb,i)
}  
for(i in 1:10000) {
  b1 <- sample(chum2016D$Collection, size = 1)
  
  res <- chum2016D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.chum2016D[i,] <- res[]
  setTxtProgressBar(pb,i)
}  
for(i in 1:10000) {
  b1 <- sample(chum2016J$Collection, size = 1)
  
  res <- chum2016J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.chum2016J[i,] <- res[]
  setTxtProgressBar(pb,i)
}  
for(i in 1:10000) {
  b1 <- sample(chum2017D$Collection, size = 1)
  
  res <- chum2017D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.chum2017D[i,] <- res[]
  setTxtProgressBar(pb,i)
} 
for(i in 1:10000) {
  b1 <- sample(chum2017J$Collection, size = 1)
  
  res <- chum2017J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.chum2017J[i,] <- res[]
  setTxtProgressBar(pb,i)
} 
for(i in 1:10000) {
  b1 <- sample(chum2018D$Collection, size = 1)
  
  res <- chum2018D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.chum2018D[i,] <- res[]
  setTxtProgressBar(pb,i)
} 
for(i in 1:10000) {
  b1 <- sample(chum2018J$Collection, size = 1)
  
  res <- chum2018J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.chum2018J[i,] <- res[]
  setTxtProgressBar(pb,i)
} 

#pink
for(i in 1:10000) {
  b1 <- sample(pink2015D$Collection, size = 1)
  
  res <- pink2015D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.pink2015D[i,] <- res[]
  setTxtProgressBar(pb,i)
}  
for(i in 1:10000) {
  b1 <- sample(pink2015J$Collection, size = 1)
  
  res <- pink2015J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.pink2015J[i,] <- res[]
  setTxtProgressBar(pb,i)
}  
for(i in 1:10000) {
  b1 <- sample(pink2016D$Collection, size = 1)
  
  res <- pink2016D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.pink2016D[i,] <- res[]
  setTxtProgressBar(pb,i)
}  
for(i in 1:10000) {
  b1 <- sample(pink2016J$Collection, size = 1)
  
  res <- pink2016J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.pink2016J[i,] <- res[]
  setTxtProgressBar(pb,i)
}  
for(i in 1:10000) {
  b1 <- sample(pink2017D$Collection, size = 1)
  
  res <- pink2017D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.pink2017D[i,] <- res[]
  setTxtProgressBar(pb,i)
} 
for(i in 1:10000) {
  b1 <- sample(pink2017J$Collection, size = 1)
  
  res <- pink2017J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.pink2017J[i,] <- res[]
  setTxtProgressBar(pb,i)
} 
for(i in 1:10000) {
  b1 <- sample(pink2018D$Collection, size = 1)
  
  res <- pink2018D %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.pink2018D[i,] <- res[]
  setTxtProgressBar(pb,i)
} 
for(i in 1:10000) {
  b1 <- sample(pink2018J$Collection, size = 1)
  
  res <- pink2018J %>%
    group_by(Collection) %>% 
    filter(Collection == b1) %>% 
    sample_n(n(), ufn, replace = TRUE) %>% 
    summarise(leps = mean(all.leps))
  
  lepboot.pink2018J[i,] <- res[]
  setTxtProgressBar(pb,i)
}

#now we're going to plot all this

#first thing is to sort the dataframes (based on value of the bootstraps)
#and pick the 5000th (estimate), 9750th (upper confidence), and 250th (lower confidence) values

#cals
calboot.sock2015D <- calboot.sock2015D[order(calboot.sock2015D$Caligus),]
calboot.sock2015J <- calboot.sock2015J[order(calboot.sock2015J$Caligus),]
calboot.sock2016D <- calboot.sock2016D[order(calboot.sock2016D$Caligus),]
calboot.sock2016J <- calboot.sock2016J[order(calboot.sock2016J$Caligus),]
calboot.sock2017D <- calboot.sock2017D[order(calboot.sock2017D$Caligus),]
calboot.sock2017J <- calboot.sock2017J[order(calboot.sock2017J$Caligus),]
calboot.sock2018D <- calboot.sock2018D[order(calboot.sock2018D$Caligus),]
calboot.sock2018J <- calboot.sock2018J[order(calboot.sock2018J$Caligus),]
calboot.chum2015D <- calboot.chum2015D[order(calboot.chum2015D$Caligus),]
calboot.chum2015J <- calboot.chum2015J[order(calboot.chum2015J$Caligus),]
calboot.chum2016D <- calboot.chum2016D[order(calboot.chum2016D$Caligus),]
calboot.chum2016J <- calboot.chum2016J[order(calboot.chum2016J$Caligus),]
calboot.chum2017D <- calboot.chum2017D[order(calboot.chum2017D$Caligus),]
calboot.chum2017J <- calboot.chum2017J[order(calboot.chum2017J$Caligus),]
calboot.chum2018D <- calboot.chum2018D[order(calboot.chum2018D$Caligus),]
calboot.chum2018J <- calboot.chum2018J[order(calboot.chum2018J$Caligus),]
calboot.pink2015D <- calboot.pink2015D[order(calboot.pink2015D$Caligus),]
calboot.pink2015J <- calboot.pink2015J[order(calboot.pink2015J$Caligus),]
calboot.pink2016D <- calboot.pink2016D[order(calboot.pink2016D$Caligus),]
calboot.pink2016J <- calboot.pink2016J[order(calboot.pink2016J$Caligus),]
calboot.pink2017D <- calboot.pink2017D[order(calboot.pink2017D$Caligus),]
calboot.pink2017J <- calboot.pink2017J[order(calboot.pink2017J$Caligus),]
calboot.pink2018D <- calboot.pink2018D[order(calboot.pink2018D$Caligus),]
calboot.pink2018J <- calboot.pink2018J[order(calboot.pink2018J$Caligus),]

#leps 
lepboot.sock2015D <- lepboot.sock2015D[order(lepboot.sock2015D$Leps),]
lepboot.sock2015J <- lepboot.sock2015J[order(lepboot.sock2015J$Leps),]
lepboot.sock2016D <- lepboot.sock2016D[order(lepboot.sock2016D$Leps),]
lepboot.sock2016J <- lepboot.sock2016J[order(lepboot.sock2016J$Leps),]
lepboot.sock2017D <- lepboot.sock2017D[order(lepboot.sock2017D$Leps),]
lepboot.sock2017J <- lepboot.sock2017J[order(lepboot.sock2017J$Leps),]
lepboot.sock2018D <- lepboot.sock2018D[order(lepboot.sock2018D$Leps),]
lepboot.sock2018J <- lepboot.sock2018J[order(lepboot.sock2018J$Leps),]
lepboot.chum2015D <- lepboot.chum2015D[order(lepboot.chum2015D$Leps),]
lepboot.chum2015J <- lepboot.chum2015J[order(lepboot.chum2015J$Leps),]
lepboot.chum2016D <- lepboot.chum2016D[order(lepboot.chum2016D$Leps),]
lepboot.chum2016J <- lepboot.chum2016J[order(lepboot.chum2016J$Leps),]
lepboot.chum2017D <- lepboot.chum2017D[order(lepboot.chum2017D$Leps),]
lepboot.chum2017J <- lepboot.chum2017J[order(lepboot.chum2017J$Leps),]
lepboot.chum2018D <- lepboot.chum2018D[order(lepboot.chum2018D$Leps),]
lepboot.chum2018J <- lepboot.chum2018J[order(lepboot.chum2018J$Leps),]
lepboot.pink2015D <- lepboot.pink2015D[order(lepboot.pink2015D$Leps),]
lepboot.pink2015J <- lepboot.pink2015J[order(lepboot.pink2015J$Leps),]
lepboot.pink2016D <- lepboot.pink2016D[order(lepboot.pink2016D$Leps),]
lepboot.pink2016J <- lepboot.pink2016J[order(lepboot.pink2016J$Leps),]
lepboot.pink2017D <- lepboot.pink2017D[order(lepboot.pink2017D$Leps),]
lepboot.pink2017J <- lepboot.pink2017J[order(lepboot.pink2017J$Leps),]
lepboot.pink2018D <- lepboot.pink2018D[order(lepboot.pink2018D$Leps),]
lepboot.pink2018J <- lepboot.pink2018J[order(lepboot.pink2018J$Leps),]

#now put the data in a format I can use to plot it all 

#make the ones that will go in each df
sal1 <- c('Chum','Chum','Chum','Chum','Chum','Chum','Chum','Chum')
sal2 <- c('Pink','Pink','Pink','Pink','Pink','Pink','Pink','Pink')
sal3 <- c('Sockeye','Sockeye','Sockeye','Sockeye','Sockeye','Sockeye','Sockeye','Sockeye')
year <- c('2015','2015','2016','2016','2017','2017','2018','2018')
Region<- c('DI','JS','DI','JS','DI','JS','DI','JS')
lice1 <- c('C. clemensi', 'C. clemensi','C. clemensi', 'C. clemensi',
           'C. clemensi', 'C. clemensi','C. clemensi', 'C. clemensi')
lice2 <- c('L. salmonis', 'L. salmonis', 'L. salmonis', 'L. salmonis',
           'L. salmonis', 'L. salmonis', 'L. salmonis', 'L. salmonis')

#make the main dfs calling the indexes I want from the bootstrapped dfs

#chum caligus
boot.chumcalcoeffs<-c(calboot.chum2015D[5000,2],calboot.chum2015J[5000,2], calboot.chum2016D[5000,2], calboot.chum2016J[5000,2],
                      calboot.chum2017D[5000,2],calboot.chum2017J[5000,2], calboot.chum2018D[5000,2], calboot.chum2018J[5000,2])
boot.chumcalupCI <- c(calboot.chum2015D[9750,2],calboot.chum2015J[9750,2], calboot.chum2016D[9750,2], calboot.chum2016J[9750,2],
                      calboot.chum2017D[9750,2],calboot.chum2017J[9750,2], calboot.chum2018D[9750,2], calboot.chum2018J[9750,2])
boot.chumcalloCI <- c(calboot.chum2015D[250,2], calboot.chum2015J[250,2],  calboot.chum2016D[250,2],  calboot.chum2016J[250,2],
                      calboot.chum2017D[250,2], calboot.chum2017J[250,2],  calboot.chum2018D[250,2],  calboot.chum2018J[250,2])
boot.chumsregioncal <- rename(data.frame(boot.chumcalcoeffs,boot.chumcalupCI,boot.chumcalloCI,sal1,year,Region,lice1),
                         coeffs = boot.chumcalcoeffs, upCI = boot.chumcalupCI, loCI = boot.chumcalloCI,
                         lice = lice1, sal = sal1)

#chum leps
boot.chumlepcoeffs<-c(lepboot.chum2015D[5000,2], lepboot.chum2015J[5000,2], lepboot.chum2016D[5000,2], lepboot.chum2016J[5000,2],
                      lepboot.chum2017D[5000,2], lepboot.chum2017J[5000,2], lepboot.chum2018D[5000,2], lepboot.chum2018J[5000,2])
boot.chumlepupCI <- c(lepboot.chum2015D[9750,2], lepboot.chum2015J[9750,2], lepboot.chum2016D[9750,2], lepboot.chum2016J[9750,2],
                      lepboot.chum2017D[9750,2], lepboot.chum2017J[9750,2], lepboot.chum2018D[9750,2], lepboot.chum2018J[9750,2])
boot.chumleploCI <- c(lepboot.chum2015D[250,2],  lepboot.chum2015J[250,2],  lepboot.chum2016D[250,2],  lepboot.chum2016J[250,2],
                      lepboot.chum2017D[250,2],  lepboot.chum2017J[250,2],  lepboot.chum2018D[250,2],  lepboot.chum2018J[250,2])
boot.chumsregionlep <- rename(data.frame(boot.chumlepcoeffs,boot.chumlepupCI,boot.chumleploCI,sal1,year,Region,lice2),
                         coeffs = boot.chumlepcoeffs, upCI = boot.chumlepupCI, loCI = boot.chumleploCI,
                         sal = sal1, lice = lice2)

#pink caligus
boot.pinkcalcoeffs<-c(calboot.pink2015D[5000,2], calboot.pink2015J[5000,2], calboot.pink2016D[5000,2], calboot.pink2016J[5000,2],
                      calboot.pink2017D[5000,2], calboot.pink2017J[5000,2], calboot.pink2018D[5000,2], calboot.pink2018J[5000,2])
boot.pinkcalupCI <- c(calboot.pink2015D[9750,2], calboot.pink2015J[9750,2], calboot.pink2016D[9750,2], calboot.pink2016J[9750,2],
                      calboot.pink2017D[9750,2], calboot.pink2017J[9750,2], calboot.pink2018D[9750,2], calboot.pink2018J[9750,2])
boot.pinkcalloCI <- c(calboot.pink2015D[250,2],  calboot.pink2015J[250,2],  calboot.pink2016D[250,2],  calboot.pink2016J[250,2],
                      calboot.pink2017D[250,2],  calboot.pink2017J[250,2],  calboot.pink2018D[250,2],  calboot.pink2018J[250,2])
boot.pinkregioncal <- rename(data.frame(boot.pinkcalcoeffs,boot.pinkcalupCI,boot.pinkcalloCI,sal2,year,Region,lice1),
                        coeffs = boot.pinkcalcoeffs, upCI = boot.pinkcalupCI, loCI = boot.pinkcalloCI,
                        sal = sal2, lice = lice1)

#pink leps
boot.pinklepscoeffs<-c(lepboot.pink2015D[5000,2], lepboot.pink2015J[5000,2], lepboot.pink2016D[5000,2], lepboot.pink2016J[5000,2],
                       lepboot.pink2017D[5000,2], lepboot.pink2017J[5000,2], lepboot.pink2018D[5000,2], lepboot.pink2018J[5000,2])
boot.pinklepsupCI <- c(lepboot.pink2015D[9750,2], lepboot.pink2015J[9750,2], lepboot.pink2016D[9750,2], lepboot.pink2016J[9750,2],
                       lepboot.pink2017D[9750,2], lepboot.pink2017J[9750,2], lepboot.pink2018D[9750,2], lepboot.pink2018J[9750,2])
boot.pinklepsloCI <- c(lepboot.pink2015D[250,2],  lepboot.pink2015J[250,2],  lepboot.pink2016D[250,2],  lepboot.pink2016J[250,2],
                       lepboot.pink2017D[250,2],  lepboot.pink2017J[250,2],  lepboot.pink2018D[250,2],  lepboot.pink2018J[250,2])
boot.pinkregionleps <- rename(data.frame(boot.pinklepscoeffs,boot.pinklepsupCI,boot.pinklepsloCI,sal2,year,Region,lice2),
                         coeffs = boot.pinklepscoeffs, upCI = boot.pinklepsupCI, loCI =  boot.pinklepsloCI,
                         sal = sal2, lice = lice2)

#sockeye caligus
boot.sockcalcoeffs<-c(calboot.sock2015D[5000,2], calboot.sock2015J[5000,2], calboot.sock2016D[5000,2], calboot.sock2016J[5000,2],
                      calboot.sock2017D[5000,2], calboot.sock2017J[5000,2], calboot.sock2018D[5000,2], calboot.sock2018J[5000,2])
boot.sockcalupCI <- c(calboot.sock2015D[9750,2], calboot.sock2015J[9750,2], calboot.sock2016D[9750,2], calboot.sock2016J[9750,2],
                      calboot.sock2017D[9750,2], calboot.sock2017J[9750,2], calboot.sock2018D[9750,2], calboot.sock2018J[9750,2])
boot.sockcalloCI <- c(calboot.sock2015D[250,2],  calboot.sock2015J[250,2],  calboot.sock2016D[250,2],  calboot.sock2016J[250,2],
                      calboot.sock2017D[250,2],  calboot.sock2017J[250,2],  calboot.sock2018D[250,2],  calboot.sock2018J[250,2])
boot.sockregioncal <- rename(data.frame(boot.sockcalcoeffs,boot.sockcalupCI,boot.sockcalloCI,sal3,year,Region,lice1),
                        coeffs = boot.sockcalcoeffs, upCI = boot.sockcalupCI, loCI = boot.sockcalloCI,
                        sal = sal3, lice = lice1)

#sockeye leps
boot.socklepscoeffs<-c(lepboot.sock2015D[5000,2], lepboot.sock2015J[5000,2], lepboot.sock2016D[5000,2], lepboot.sock2016J[5000,2],
                       lepboot.sock2017D[5000,2], lepboot.sock2017J[5000,2], lepboot.sock2018D[5000,2], lepboot.sock2018J[5000,2])
boot.socklepsupCI <- c(lepboot.sock2015D[9750,2], lepboot.sock2015J[9750,2], lepboot.sock2016D[9750,2], lepboot.sock2016J[9750,2],
                       lepboot.sock2017D[9750,2], lepboot.sock2017J[9750,2], lepboot.sock2018D[9750,2], lepboot.sock2018J[9750,2])
boot.socklepsloCI <- c(lepboot.sock2015D[250,2],  lepboot.sock2015J[250,2],  lepboot.sock2016D[250,2],  lepboot.sock2016J[250,2],
                       lepboot.sock2017D[250,2],  lepboot.sock2017J[250,2],  lepboot.sock2018D[250,2],  lepboot.sock2018J[250,2])
boot.sockregionleps <- rename(data.frame(boot.socklepscoeffs,boot.socklepsupCI,boot.socklepsloCI,sal3,year,Region,lice2),
                         coeffs = boot.socklepscoeffs, upCI = boot.socklepsupCI, loCI = boot.socklepsloCI,
                         sal = sal3, lice = lice2)
boot.regionestbyspchum <- rbind(boot.chumsregioncal, boot.chumsregionlep)
boot.regionestbysppink <- rbind(boot.pinkregioncal, boot.pinkregionleps)
boot.regionestbyspsock <- rbind(boot.sockregioncal, boot.sockregionleps)

#now make the plots

#make the plots
boot.regionestbyspplotchum <- boot.regionestbyspchum %>% 
  group_by(.,lice,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region, shape = lice)) +
  scale_shape_manual(values = c(17,15),labels = c('C. clemensi','L. salmonis'))+
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Chum Salmon",x = '', y = NULL,shape = 'Lice Species')+
  guides(shape = guide_legend(override.aes = list(shape = c(24,22)), type = 'b'))+
  scale_y_continuous(limits = c(0,3.0)) +
  fte_themeChum()
boot.regionestbyspplotchum
boot.regionestbyspplotpink <- boot.regionestbysppink %>% 
  group_by(.,lice,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region, shape = lice)) +
  scale_shape_manual(values = c(17,15),labels = c('C. clemensi','L. salmonis'))+
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  theme(strip.background = element_blank(),strip.placement = 'outside') +
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Pink Salmon", x = 'Year & Region', y = NULL,shape = 'Lice Species')+
  guides(shape = guide_legend(override.aes = list(shape = c(24,22)), type = 'b'))+
  scale_y_continuous(limits = c(0,3.0)) +
  fte_themePink()
boot.regionestbyspplotpink
boot.regionestbyspplotsock <- boot.regionestbyspsock %>% 
  group_by(.,lice,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region, shape = lice)) +
  scale_shape_manual(values = c(17,15),labels = c('C. clemensi','L. salmonis'))+
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  theme(strip.background = element_blank(),strip.placement = 'outside') +
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Sockeye Salmon", x = '', y = 'Bootstrapped Number of Motile Lice per Fish',shape = 'Lice Species')+
  guides(shape = guide_legend(override.aes = list(shape = c(24,22)), type = 'b'))+
  scale_y_continuous(limits = c(0,3.0))+
  fte_themeSock()
boot.regionestbyspplotsock

boot.regionboth <- plot_grid(boot.regionestbyspplotsock,boot.regionestbyspplotpink,boot.regionestbyspplotchum,
                        nrow = 1, labels = NULL, rel_widths = c(1,1,1)) 
boot.regionboth

## Now repeat but just by species of lice

#subset the dataframes
boot.regionestbyspchumLEP <- boot.regionestbyspchum %>% 
  filter(lice == 'L. salmonis')
boot.regionestbyspchumCAL <- boot.regionestbyspchum %>% 
  filter(lice == 'C. clemensi')
boot.regionestbysppinkLEP <- boot.regionestbysppink %>% 
  filter(lice == 'L. salmonis')
boot.regionestbysppinkCAL <- boot.regionestbysppink %>% 
  filter(lice == 'C. clemensi')
boot.regionestbyspsockLEP <- boot.regionestbyspsock %>% 
  filter(lice == 'L. salmonis')
boot.regionestbyspsockCAL <- boot.regionestbyspsock %>% 
  filter(lice == 'C. clemensi')

#do lep plots
boot.regionestbyspplotchumLEP <- boot.regionestbyspchumLEP %>% 
  group_by(.,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region)) +
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Chum Salmon", x = '', y = NULL, Region = c('Discovery Islands', 'Johnstone Strait'))+
  scale_y_continuous(limits = c(0,3.0)) +
  fte_themeChum()
boot.regionestbyspplotchumLEP
boot.regionestbyspplotpinkLEP <- boot.regionestbysppinkLEP %>% 
  group_by(.,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region)) +
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Pink Salmon", x = 'Year and Region', y = NULL)+
  scale_y_continuous(limits = c(0,3.0)) +
  fte_themePink()
boot.regionestbyspplotpinkLEP
boot.regionestbyspplotsockLEP <- boot.regionestbyspsockLEP %>% 
  group_by(.,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region)) +
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  theme(strip.background = element_blank(),strip.placement = 'outside') +
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Sockeye Salmon", x = '', y = 'Bootstrapped Number of Motile L. salmonis Lice Per Fish')+
  scale_y_continuous(limits = c(0,3.0))+
  fte_themeSock()
boot.regionestbyspplotsockLEP

boot.regionLEP <- plot_grid(boot.regionestbyspplotsockLEP,boot.regionestbyspplotpinkLEP,boot.regionestbyspplotchumLEP,
                       nrow = 1, labels = NULL) 
boot.regionLEP #print 800x450

#do Cal plots
boot.regionestbyspplotchumCAL <- boot.regionestbyspchumCAL %>% 
  group_by(.,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region)) +
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Chum Salmon", x = '', y = NULL, Region = c('Discovery Islands', 'Johnstone Strait'))+
  scale_y_continuous(limits = c(0,2.5)) +
  fte_themeChum()
boot.regionestbyspplotchumCAL
boot.regionestbyspplotpinkCAL <- boot.regionestbysppinkCAL %>% 
  group_by(.,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region)) +
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Pink Salmon", x = 'Year and Region', y = NULL)+
  scale_y_continuous(limits = c(0,2.5)) +
  fte_themePink()
boot.regionestbyspplotpinkCAL
boot.regionestbyspplotsockCAL <- boot.regionestbyspsockCAL %>% 
  group_by(.,Region,year) %>% 
  ggplot(aes(x=Region, y = coeffs, colour = Region)) +
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~year, nrow=1, strip.position = 'bottom')+
  theme(strip.background = element_blank(),strip.placement = 'outside') +
  scale_color_manual(values=c('grey60', 'grey20'))+
  labs(title = "Sockeye Salmon", x = '', y = 'Bootstrapped Number of Motile C. clemensi Lice Per Fish')+
  scale_y_continuous(limits = c(0,2.5))+
  fte_themeSock()
boot.regionestbyspplotsockCAL

boot.regionCAL <- plot_grid(boot.regionestbyspplotsockCAL,boot.regionestbyspplotpinkCAL,boot.regionestbyspplotchumCAL,
                       nrow = 1, labels = NULL) 
boot.regionCAL #export 800x450



##################################################### Greyscale plots

## mean lice per fish per collection both species, output height/width = 800,500
g.s.statmeanplot <- meanliceperfishpersp %>% 
  group_by(., spp) %>% 
  ggplot(., aes(x = collection, y = av.lice, fill = spp)) + 
  geom_histogram(stat = "identity") +
  theme_classic()+ 
  scale_color_manual(values=c('grey85', 'grey50', 'grey20')) +
  scale_fill_manual(values=c('grey85', 'grey50', 'grey20'), 
                    name = 'Salmon Species', labels = c('Chum', 'Pink', 'Sockeye')) + 
  labs(x = 'Collection', y = 'Average Number of Motile Lice per Fish')+  
  theme(legend.position = c(0.85,0.7))+ 
  scale_y_continuous(limits=c(0,5))+
  annotate('text', x = 25, y = 5, label= 'C. clemensi & L. salmonis', fontface = 3, size = 5)
g.s.statmeanplot

## leps effect plot, export height/width = 1200,700
g.leps3fullmodplot <- lepsall3 %>% 
  group_by(., yr,sal) %>% 
  ggplot(aes(x = sal, y = coeffs, colour = sal)) +
  geom_errorbar(aes(ymin=loCI, ymax = upCI,width = 0), colour = 'Black')+
  geom_point(size = 4) +
  facet_wrap(~yr,nrow=1,strip.position = "bottom")+
  theme(strip.background = element_blank(), strip.placement = "outside") + 
  scale_color_manual(leg_title,values=c('grey85', 'grey50', 'grey20'))
labs(title = "L. salmonis Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish')
g.leps3fullmodplot

## Cal effect plot, export height/width = 1200,700
g.cal3fullmodplot <- calall3 %>% 
  group_by(., yr,sal) %>% 
  ggplot(aes(x = sal, y = coeffs, colour = sal)) +
  geom_errorbar(aes(ymin=loCI, ymax = upCI,width = 0), colour = 'Black')+
  geom_point(size = 4) +
  facet_wrap(~yr,nrow=1,strip.position = "bottom")+
  theme(strip.background = element_blank(), strip.placement = "outside") + 
  scale_color_manual(leg_title,values=c('grey85', 'grey50', 'grey20'))+
  labs(title = "C. clemensi Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish')
g.cal3fullmodplot

## lice effects plot of both species combined, output height/width = 1200,700
g.bothfull3modplot <- alllice3forplot %>% 
  group_by(., yr,sal,lice) %>% 
  ggplot(aes(x=sal, y = coeffs, colour = sal, shape = lice)) +
  scale_shape_manual(values = c(17,15),labels = c('L. salmonis', 'C. clemensi'))+
  geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
  geom_point(size = 4, position = position_dodge(width=0.8)) +
  facet_wrap(~yr, nrow=1, strip.position = 'bottom')+
  theme(strip.background = element_blank(),strip.placement = 'outside') +
  scale_color_manual(leg_title,values=c('grey85', 'grey50', 'grey20'))+
  labs(title = "Lice Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish',shape = 'Lice Species')+
  guides(shape = guide_legend(override.aes = list(shape = c(24,22)), type = 'b'))
g.bothfull3modplot

## lice per fish per lice species, export height/width = 800, 500 
g.CALs.statmeanplot <- meanCALperfishpersp %>% 
  group_by(., spp) %>% 
  ggplot(., aes(x = collection, y = av.cal, fill = spp)) + 
  geom_histogram(stat = "identity") +
  scale_y_continuous(limits = c(0,3))+
  theme_classic() +
  scale_color_manual(values=c('grey85', 'grey50', 'grey20')) +
  scale_fill_manual(values=c('grey85', 'grey50', 'grey20'),
                    name = 'Salmon Species', labels = c('Chum', 'Pink', 'Sockeye')) +
  labs(x = 'Collection', y = 'Average Number of Motile Lice per Fish')+
  theme(legend.position = 'None')+ 
  annotate('text', x = 25, y = 2.8, label= 'C. clemensi', fontface = 3, size = 5)
g.CALs.statmeanplot 
g.LEPs.statmeanplot <- meanLEPperfishpersp %>% 
  group_by(., spp) %>% 
  ggplot(., aes(x = collection, y = av.leps, fill = spp)) + 
  geom_histogram(stat = "identity") +
  scale_y_continuous(limits = c(0,3))+
  theme_classic()+
  scale_color_manual(values=c('grey85', 'grey50', 'grey20')) +
  scale_fill_manual(values=c('grey85', 'grey50', 'grey20'),
                    name = 'Salmon Species', labels = c('Chum', 'Pink', 'Sockeye')) + 
  labs(x = 'Collection', y = 'Average Number of Motile Lice per Fish')+
  theme(legend.position = c(0.85,0.6))+ 
  annotate('text', x = 25, y = 2.8, label= 'L. salmonis', fontface = 3, size = 5)
g.LEPs.statmeanplot
g.CalvLep <- plot_grid(g.CALs.statmeanplot, g.LEPs.statmeanplot)
g.CalvLep 











chumrmod.calnb0 <- glmmadmb(all.cal ~ 1 + (1|week), 
                            data = chum.region, family = 'nbinom', zeroInflation = FALSE)
chumrmod.lepsnb0 <- glmmadmb(all.leps ~ 1 + (1|week), 
                             data = chum.region, family = 'nbinom', zeroInflation = FALSE)
pinkrmod.calnb0 <- glmmadmb(all.cal ~ 1  + (1|week), 
                            data = pink.region, family = 'nbinom', zeroInflation = FALSE)
pinkrmod.lepsnb0 <- glmmadmb(all.leps ~ 1 + (1|week), 
                             data = pink.region, family = 'nbinom', zeroInflation = FALSE)
sockrmod.calnb0 <- glmmadmb(all.cal ~ 1 + (1|week), 
                            data = sock.region, family = 'nbinom', zeroInflation = FALSE)
sockrmod.lepsnb0 <- glmmadmb(all.leps ~ 1 + (1|week), 
                             data = sock.region, family = 'nbinom', zeroInflation = FALSE)

chumrmod.calnb1 <- glmmadmb(all.cal ~ site.region - 1 + (1|week), 
                            data = chum.region, family = 'nbinom', zeroInflation = FALSE)
chumrmod.lepsnb1 <- glmmadmb(all.leps ~ site.region - 1 + (1|week), 
                             data = chum.region, family = 'nbinom', zeroInflation = FALSE)
pinkrmod.calnb1 <- glmmadmb(all.cal ~ site.region - 1  + (1|week), 
                            data = pink.region, family = 'nbinom', zeroInflation = FALSE)
pinkrmod.lepsnb1 <- glmmadmb(all.leps ~ site.region - 1 + (1|week), 
                             data = pink.region, family = 'nbinom', zeroInflation = FALSE)
sockrmod.calnb1 <- glmmadmb(all.cal ~ site.region - 1 + (1|week), 
                            data = sock.region, family = 'nbinom', zeroInflation = FALSE)
sockrmod.lepsnb1 <- glmmadmb(all.leps ~ site.region - 1 + (1|week), 
                             data = sock.region, family = 'nbinom', zeroInflation = FALSE)

chumrmod.calnb2 <- glmmadmb(all.cal ~ year - 1 + (1|week), 
                            data = chum.region, family = 'nbinom', zeroInflation = FALSE)
chumrmod.lepsnb2 <- glmmadmb(all.leps ~ year - 1 + (1|week), 
                             data = chum.region, family = 'nbinom', zeroInflation = FALSE)
pinkrmod.calnb2 <- glmmadmb(all.cal ~ year - 1  + (1|week), 
                            data = pink.region, family = 'nbinom', zeroInflation = FALSE)
pinkrmod.lepsnb2 <- glmmadmb(all.leps ~ year - 1 + (1|week), 
                             data = pink.region, family = 'nbinom', zeroInflation = FALSE)
sockrmod.calnb2 <- glmmadmb(all.cal ~ year - 1 + (1|week), 
                            data = sock.region, family = 'nbinom', zeroInflation = FALSE)
sockrmod.lepsnb2 <- glmmadmb(all.leps ~ year - 1 + (1|week), 
                             data = sock.region, family = 'nbinom', zeroInflation = FALSE)



chumrmod.calp0 <- glmmadmb(all.cal ~ 1 + (1|week), 
                           data = chum.region, family = 'poisson', zeroInflation = TRUE)
chumrmod.lepsp0 <- glmmadmb(all.leps ~ site.region + year - 1 + (1|week), 
                            data = chum.region, family = 'poisson', zeroInflation = TRUE)
pinkrmod.calp0 <- glmmadmb(all.cal ~ 1  + (1|week), 
                           data = pink.region, family = 'poisson', zeroInflation = TRUE)
pinkrmod.lepsp0 <- glmmadmb(all.leps ~ 1 + (1|week), 
                            data = pink.region, family = 'poisson', zeroInflation = TRUE)
sockrmod.calp0 <- glmmadmb(all.cal ~ 1 + (1|week), 
                           data = sock.region, family = 'poisson', zeroInflation = TRUE)
sockrmod.lepsp0 <- glmmadmb(all.leps ~ 1 + (1|week), 
                            data = sock.region, family = 'poisson', zeroInflation = TRUE)

chumrmod.calp1 <- glmmadmb(all.cal ~ year - 1 + (1|week), 
                           data = chum.region, family = 'poisson', zeroInflation = TRUE)
chumrmod.lepsp1 <- glmmadmb(all.leps ~ year - 1 + (1|week), 
                            data = chum.region, family = 'poisson', zeroInflation = TRUE)
pinkrmod.calp1 <- glmmadmb(all.cal ~ year - 1  + (1|week), 
                           data = pink.region, family = 'poisson', zeroInflation = TRUE)
pinkrmod.lepsp1 <- glmmadmb(all.leps ~ year - 1 + (1|week), 
                            data = pink.region, family = 'poisson', zeroInflation = TRUE)
sockrmod.calp1 <- glmmadmb(all.cal ~ year - 1 + (1|week), 
                           data = sock.region, family = 'poisson', zeroInflation = TRUE)
sockrmod.lepsp1 <- glmmadmb(all.leps ~ year - 1 + (1|week), 
                            data = sock.region, family = 'poisson', zeroInflation = TRUE)

chumrmod.calp2 <- glmmadmb(all.cal ~ site.region - 1 + (1|week), 
                           data = chum.region, family = 'poisson', zeroInflation = TRUE)
chumrmod.lepsp2 <- glmmadmb(all.leps ~ site.region - 1 + (1|week), 
                            data = chum.region, family = 'poisson', zeroInflation = TRUE)
pinkrmod.calp2 <- glmmadmb(all.cal ~ site.region - 1  + (1|week), 
                           data = pink.region, family = 'poisson', zeroInflation = TRUE)
pinkrmod.lepsp2 <- glmmadmb(all.leps ~ site.region - 1 + (1|week), 
                            data = pink.region, family = 'poisson', zeroInflation = TRUE)
sockrmod.calp2 <- glmmadmb(all.cal ~ site.region - 1 + (1|week), 
                           data = sock.region, family = 'poisson', zeroInflation = TRUE)
sockrmod.lepsp2 <- glmmadmb(all.leps ~ site.region - 1 + (1|week), 
                            data = sock.region, family = 'poisson', zeroInflation = TRUE)




summary(chumrmod.calnb0)
summary(chumrmod.lepsnb0)
summary(pinkrmod.calnb0)
summary(pinkrmod.lepsnb0)
summary(sockrmod.calnb0)
summary(sockrmod.lepsnb0)

summary(chumrmod.calnb1)
summary(chumrmod.lepsnb1)
summary(pinkrmod.calnb1)
summary(pinkrmod.lepsnb1)
summary(sockrmod.calnb1)
summary(sockrmod.lepsnb1)

summary(chumrmod.calnb2)
summary(chumrmod.lepsnb2)
summary(pinkrmod.calnb2)
summary(pinkrmod.lepsnb2)
summary(sockrmod.calnb2)
summary(sockrmod.lepsnb2)


summary(chumrmod.calp0)
summary(chumrmod.lepsp0)
summary(pinkrmod.calp0)
summary(pinkrmod.lepsp0)
summary(sockrmod.calp0)
summary(sockrmod.lepsp0)

summary(chumrmod.calp1)
summary(chumrmod.lepsp1)
summary(pinkrmod.calp1)
summary(pinkrmod.lepsp1)
summary(sockrmod.calp1)
summary(sockrmod.lepsp1)

summary(chumrmod.calp2)
summary(chumrmod.lepsp2)
summary(pinkrmod.calp2)
summary(pinkrmod.lepsp2)
summary(sockrmod.calp2)
summary(sockrmod.lepsp2)